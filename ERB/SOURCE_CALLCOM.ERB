@CALL_COM(ARG)

RESULT = 0
TFLAG:弱点コマンドフラグ = 0
弱点コマンドカテゴリ = 
IF TSTR:SELECTCOM_S受け渡し != ""
	TRYCALLFORM CAN_COM_S%TSTR:SELECTCOM_S受け渡し%
	TRYCALLFORMF COMTYPE_S_%TSTR:SELECTCOM_S受け渡し%
	TRYCALLFORM COM_S%TSTR:SELECTCOM_S受け渡し%
	LOCAL:1 = RESULT
	IF LOCAL:1 >= 0
		LOCALS = %TSTR:SELECTCOM_S受け渡し%
		IF STRFIND(弱点コマンドカテゴリ, "リダイレクト") >= 0
			LOCALS = %SUBSTRING(弱点コマンドカテゴリ, 12)%
		ENDIF
		IF 弱点コマンドカテゴリ != ""
			FOR LOCAL, 0, 5
				IF 弱点コマンド枠:TARGET:LOCAL == @"%TSTR:SELECTCOM_S受け渡し%"
					TFLAG:弱点コマンドフラグ = 1
					SIF 弱点看破:TARGET:LOCAL == 0
						弱点看破:TARGET:LOCAL = 1
				ENDIF
			NEXT
		ENDIF
	ENDIF
	RETURN LOCAL:1	
ELSE
	TRYCALLFORM CAN_COM{SELECTCOM}
	TRYCALLFORMF COMTYPE_{SELECTCOM}
	TRYCALLFORM COM{SELECTCOM}
	LOCAL:1 = RESULT
	IF LOCAL:1 >= 0
		SELECTCASE SELECTCOM
			CASE 380 TO 384
			LOCALS = {SELECTCOM}_{NO:TARGET}
			CASE 380 TO 384
			LOCALS = {SELECTCOM}_{CFLAG:MASTER:現在マップ種別}_{CFLAG:MASTER:現在位置}
			CASEELSE
			LOCALS = {SELECTCOM}
		ENDSELECT
		IF STRFIND(弱点コマンドカテゴリ, "リダイレクト") >= 0
			LOCALS = %SUBSTRING(弱点コマンドカテゴリ, 12)%
		ENDIF
		IF 弱点コマンドカテゴリ != ""
			FOR LOCAL, 0, 5
				IF 弱点コマンド枠:TARGET:LOCAL == LOCALS
					TFLAG:弱点コマンドフラグ = 1
					SIF 弱点看破:TARGET:LOCAL == 0
						弱点看破:TARGET:LOCAL = 1
				ENDIF
			NEXT
		ENDIF
	ENDIF
	RETURN LOCAL:1
ENDIF


