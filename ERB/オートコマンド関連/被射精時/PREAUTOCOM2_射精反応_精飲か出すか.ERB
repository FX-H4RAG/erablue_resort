;------------------------------------------------------------------------------
;口に出すと飲んでくれる
;------------------------------------------------------------------------------
@PRE_AUTOCOM2

CALL SOURCE_CALC_露出_反感無し(AUTOCOM_相手番号保存, PLAYER, 50)
SIF 精飲フラグ(AUTOCOM_相手番号保存)
	EXP:AUTOCOM_相手番号保存:精飲経験 += 5

RCVAR:AUTOCOM_相手番号保存:精飲フラグ = 精飲フラグ(AUTOCOM_相手番号保存)
[SKIPSTART]
IF TFLAG:フィニッシュ相手番号2
	CALL SOURCE_CALC_露出_反感無し(TFLAG:フィニッシュ相手番号2, PLAYER, 50)
	SIF 精飲フラグ(TFLAG:フィニッシュ相手番号2)
		EXP:(TFLAG:フィニッシュ相手番号2):精飲経験 += 5
	TFLAG:フィニッシュ相手番号2 = 0
ENDIF
[SKIPEND]

@PRE_AUTOCOM_ABLE2(キャラ番号)
#DIM キャラ番号
;口内射精直後
SIF RFLAG:フィニッシュ場所 != 2
	RETURN 0
;フィニッシュ相手であること
SIF キャラ番号 != RFLAG:フィニッシュ相手番号
	RETURN 0

RETURN 1

@MESSAGE_PRE_AUTOCOM2
;RFLAG:コマンド結果受渡し変数　もう一人居た場合のキャラ番号
;RFLAG:コマンド結果受渡し変数1　キャラ番号が小さい方の反応  
;RFLAG:コマンド結果受渡し変数2　キャラ番号が大きい方の反応
;　0x 相手とは絡み無し 1x キスされる 2x キスする
;　x0 吐き出す x1 飲まされる x2 なんとか飲み込む x3 喜んで飲み込む
#DIM 相手番号1
#DIM 相手番号2
#DIM 精飲フラグ1
#DIM 精飲フラグ2

相手番号1 = 0
相手番号2 = 0


[SKIPSTART]
IF TFLAG:フィニッシュ相手番号2
	相手番号1 = AUTOCOM_相手番号保存
	相手番号2 = TFLAG:フィニッシュ相手番号2
	精飲フラグ1 = 精飲フラグ(相手番号1)
	精飲フラグ2 = 精飲フラグ(相手番号2)
	IF !精飲フラグ1 && !精飲フラグ2
		;どちらも吐き出す
		;相手番号1の方が技巧が高くなるように
		SIF ABL:相手番号1:技巧 < ABL:相手番号2:技巧
			SWAP 相手番号1, 相手番号2
		PRINTFORM %CALLNAME:相手番号1%
		IF MIN(ABL:相手番号1:技巧, ABL:相手番号2:技巧) > 2
			PRINTFORML と%CALLNAME:相手番号2%は、口に出された精液を揃ってティッシュに吐き出し、片付けた
		ELSEIF MAX(ABL:相手番号1:技巧, ABL:相手番号2:技巧) < 3
			PRINTFORML と%CALLNAME:相手番号2%は、二人とも口に出された精液に咳き込んでしまい、口から吐き出した…
		ELSE
			PRINTFORML は、%CALLNAME:相手番号2%が精液にむせて吐き出しているのを尻目に、上手に口内の精液を処分している
		ENDIF
		RFLAG:コマンド結果受渡し変数1 = 0
		RFLAG:コマンド結果受渡し変数2 = 0
	ELSEIF 精飲フラグ1 + 精飲フラグ2 == 1
		;片方が吐き出し、もう片方はなんとか飲み込む
	ELSEIF MAX(精飲フラグ1, 精飲フラグ2) == 2 && MIN(精飲フラグ(相手番号), 精飲フラグ2) == 0
		;片方が吐き出し、もう片方は喜んで飲み込む
		;飲み込めない相手にキスして啜り取る
		;キスで無理やり飲ませる
	ELSEIF MAX(精飲フラグ1, 精飲フラグ2) == 1
		;どちらもなんとか飲み込む
	ELSEIF MIN(精飲フラグ1, 精飲フラグ2) == 1
		;片方はなんとか、もう片方は喜んで飲み込む
		;キスでおすそ分け
		;キスして奪い取る
	ELSE 
		;どちらも喜んで飲み込む
		;さらにスペレズ
	ENDIF
	RFLAG:コマンド結果受渡し変数 = 相手番号2
	TRYCALLFORM KOJO_PRE_AUTOCOM2_{相手番号1}
	RFLAG:コマンド結果受渡し変数 = 相手番号1
	TRYCALLFORM KOJO_PRE_AUTOCOM2_{相手番号2}
	RETURN
ENDIF
[SKIPEND]

PRINTFORM %CALLNAME:AUTOCOM_相手番号保存%は口に出された精液
IF RCVAR:AUTOCOM_相手番号保存:精飲フラグ
	PRINT をそのまま飲み下し
	IF ABL:AUTOCOM_相手番号保存:技巧 > 2 || RCVAR:AUTOCOM_相手番号保存:精飲フラグ > 1
		PRINTL 、
		PRINTL 口を開いて全部飲み干した咥内を見せてきた…
	ELSE
		PRINTL た…
	ENDIF
ELSE
	IF ABL:AUTOCOM_相手番号保存:技巧 > 2
		PRINTL を手早くティッシュに吐き出し、片付けた
	ELSE
		PRINTL に咳き込んでしまい、口から吐き出した…
	ENDIF
ENDIF

@精飲フラグ(ARG)
#FUNCTION
SIF !INRANGE(ARG, 0, CHARANUM-1)
	RETURNF 0
SIF (TALENT:ARG:恋慕 || TALENT:ARG:セフレ || CFLAG:ARG:性愛度 >= 経験値テーブル:(関係閾値:4)) && EXP:ARG:口淫経験 + EXP:ARG:精飲経験 >= 60
	RETURNF 2
SIF TALENT:ARG:恋慕 || TALENT:ARG:セフレ || CFLAG:ARG:性愛度 >= 経験値テーブル:(関係閾値:3) || TALENT:ARG:性的興味 > 0 || EXP:ARG:口淫経験 >= 30
	RETURNF 1
RETURNF 0
