
@COMNAME414
#FUNCTIONS
TSTR:コマンド名受渡 = 写真を撮る

;===================================================
;コマンドタイプ
;===================================================
@COMTYPE_414
#FUNCTION
TFLAG:コマンドタイプ受渡 = COMTYPE("単独可能_うふふ")

@COM_TOOLTIP_414
LOCALS = <br>■写真を撮る<br>
LOCALS += "景切鏡を使って、景色を紙に写し取るコマンド。<br>実行した時の状況によって様々な写真が撮れる。"
LOCALS += "<br>COMタイプ：単独可能<br>取得ソース：なし"
LOCALS += "<br>固有の取得経験：なし<br>"
TSTR:ツールチップ受渡 = %LOCALS%


;-------------------------------------------------
;休憩
;-------------------------------------------------
@COM414
#DIM 覗き許可フラグ
RESULTS = 

;覗ける状態かどうかを見る
CALL COM_ABLE404
覗き許可フラグ = RESULT
IF !TARGET
	;カテゴリ１
	;自撮り・風景写真
	CALL 自撮り系風景系写真文字列算出
ELSEIF CFLAG:PLAYER:うふふ && CFLAG:TARGET:うふふ
	;カテゴリ２
	;ハメ撮り
	CALL ハメ撮り系写真文字列算出
ELSEIF 覗き許可フラグ
	;カテゴリ３
	;盗撮
	CALL 盗撮系写真文字列算出
ELSE
	;カテゴリ４
	;その他
	CALL その他写真文字列算出
ENDIF

;RESULTSに実行時メッセージが入っているので受け渡す
RSTR:コマンド結果受渡し文字列 = %RESULTS%

RETURN 1
;-------------------------------------------------
;実行判定
;-------------------------------------------------
@COM_ABLE414
;作成中のため封印
RETURN 0

;移動実行判定
SIF !TFLAG:ゲームフェイズ管理
	RETURN 0
;一括管理
SIF GLOBAL_COMABLE(414)
	RETURN RESULT
RETURN 1

;-------------------------------------------------
;実行時メッセージ
;-------------------------------------------------
@MESSAGE_COM414
PRINTFORML %CALLNAME:PLAYER%は景切鏡で写真を撮った。
;複雑な分岐結果を一箇所で管理出来るよう、メッセージを文字列で管理する
HTML_PRINT RSTR:コマンド結果受渡し文字列

;口上用のパラメータは追加してある最新の写真データベース行から持ってくる


@自撮り系風景系写真文字列算出

;まずは自撮り優先シチュの判定
;自慰直後、かつ男じゃないなら自慰写真確定
IF TALENT:PLAYER:性別 != 2
