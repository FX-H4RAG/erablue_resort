;===================================================
;首絞め
;===================================================
@COMNAME24
#FUNCTIONS
TSTR:コマンド名受渡 = 首絞め

;許可時の特別文章はここに記入
IF TFLAG:オートコマンドフラグ >= 4000
	;反転時、つまりあなたが絞める方
	許可取り文章 = %CALLNAME:TARGET%が%CALLNAME:PLAYER%に[%TSTR:コマンド名受渡%]を要求しているようだ。
ENDIF


;===================================================
;コマンドタイプ
;===================================================
@COMTYPE_24
#FUNCTION
TFLAG:コマンドタイプ受渡 = COMTYPE("うふふ")
;特殊な条件が必要なコマンドなので、弱点コマンドのランダム対象からは外す
オートコマンド許可 = 0
反転オート許可 = 3


;===================================================
;ツールチップ文章
;===================================================
@COM_TOOLTIP_24
TSTR:ツールチップ受渡 '= "<br>■首絞め<br>"
TSTR:ツールチップ受渡 += "相手の首を絞めるコマンド。<br>首絞めモードとなり、モードを変更するか性行為を終了するまで持続的に特定のソースが発生する。"
TSTR:ツールチップ受渡 += "<br>首絞めモード中は体力消費が大きくなる代わりに、受ける快楽が増幅される。"
TSTR:ツールチップ受渡 += "<br>また、相手の体力がなくなりかけた時でも行動猶予が確保されなくなる。"
TSTR:ツールチップ受渡 += "<br>COMタイプ：うふふ<br>取得ソース：快Ｓ・苦痛"
TSTR:ツールチップ受渡 += "<br>固有の取得経験：首絞め絶頂経験（TARGET・一定条件時）<br>"


;===================================================
;コマンド実行処理
;===================================================
@COM24
;-------------------------------------------------
;モードの設定
;-------------------------------------------------
CALL MODE_CHANGE("首絞め", PLAYER, TARGET)
;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
;実行時には何も起こらない

;-------------------------------------------------
;経験の処理
;-------------------------------------------------

RETURN 1


;===================================================
;実行可能判定
;===================================================
@COM_ABLE24
SIF SAVESTR:ゲームフェイズ管理 != "通常モード"
	RETURN 0
;一括管理
SIF GLOBAL_COMABLE(24)
	RETURN RESULT
SIF MODE_存在判定_ターゲット側("首絞め", TARGET)
	RETURN 0
;首絞め性癖必須
SIF 性癖素質:TARGET:首絞め < 1
	RETURN 0
;両手を何かに使ってるなら無理
SIF TEQUIP:PLAYER:指 || TEQUIP:PLAYER:指２
	RETURN 0
;実行者はあなたのみ
SIF PLAYER != MASTER
	RETURN 0

RETURN 1


;===================================================
;実行時メッセージ
;===================================================
@MESSAGE_COM24
PRINTFORML %CALLNAME:PLAYER%は%CALLNAME:TARGET%の首に手をかけると、ゆっくりと絞め始めた…
