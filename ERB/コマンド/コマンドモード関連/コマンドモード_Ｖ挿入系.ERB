@系統リスト_Ｖ挿入系(モード名)
#FUNCTION
#DIMS モード名
IF GROUPMATCH(モード名, "正常位", "後背位", "寝バック", "対面座位", "背面座位", "騎乗位", "側位", "屈曲位", "駅弁", "逆駅弁", "対面立位", "立ちバック", "同時挿入")
	RETURNF 1
ENDIF

RETURNF 0

@MODE_持続快楽_Ｖ挿入系(キャラ番号)
#DIM キャラ番号
#DIM 主犯
#DIM 詳細設定補正

IF MODE_確認("Ｖ挿入系", キャラ番号)
	主犯 = MODE_主犯確認("Ｖ挿入系", キャラ番号)
	CALL MODE詳細設定補正_Ｖ挿入系(キャラ番号, "快Ｖ")
	詳細設定補正 = 100 + RESULT
	CALL SOURCE_CALC_快Ｖ(キャラ番号, 主犯, 詳細設定補正)
	CALL SOURCE_CALC_接触(キャラ番号, 主犯, 100)
	CALL MODE詳細設定補正_Ｖ挿入系(キャラ番号, "苦痛")
	詳細設定補正 = RESULT
	CALL SOURCE_CALC_苦痛(キャラ番号, 主犯, 詳細設定補正)
	CALL SOURCE_CALC_快Ｃ(主犯, キャラ番号, 200)
	EXP:キャラ番号:Ｖ性交経験 ++
	EXP:キャラ番号:Ｖ経験 ++
	RETURN 1
ENDIF

@MODE詳細設定補正_Ｖ挿入系(キャラ番号, 補正先種類)
#DIM キャラ番号
#DIMS 補正先種類
VARSET LOCAL

SELECTCASE 補正先種類
	CASE "快Ｖ"
		IF ABL:キャラ番号:Ｖ感覚 >= V挿入強さ:キャラ番号:0
			LOCAL += 10 * V挿入強さ:キャラ番号:0
		ENDIF
		IF PALAM:キャラ番号:潤滑 >= V挿入速さ:キャラ番号:0 + 3
			LOCAL += 10 * V挿入速さ:キャラ番号:0
		ENDIF
		RETURN LOCAL
	CASE "苦痛"
		IF ABL:キャラ番号:Ｖ感覚 >= V挿入強さ:キャラ番号:0
			LOCAL += V挿入速さ:キャラ番号:0 * 200 * PAIN_CHECK_V(TARGET) / 1000
		ENDIF
		IF PALAM:キャラ番号:潤滑 >= V挿入速さ:キャラ番号:0 + 3
			LOCAL += V挿入速さ:キャラ番号:0 * 200 * PAIN_CHECK_V(TARGET) / 1000
		ENDIF
		RETURN LOCAL
ENDSELECT

@MODETYPE_正常位(ARG, ARGS)
;0=ペニス 1=クリ 2=指（手） 3=口 4=胸 5=膣 6=アナル
;挿入で使用するのはペニスと膣で1を返す
SELECTCASE ARG
	CASE 0
		SIF ARGS == "プレイヤー"
			RETURN 1
	CASE 3
		;両方ハーヴィンだと口は届く
		SIF TALENT:PLAYER:種族 == 4 && TALENT:TARGET:種族 == 4
			RETURN 0
		;どっちかがハーヴィンだと口は届かない
		SIF TALENT:PLAYER:種族 == 4 || TALENT:TARGET:種族 == 4
			RETURN 2
	CASE 5
		SIF ARGS == "ターゲット"
			RETURN 1
		SIF ARGS == "プレイヤー"
			RETURN 2
	CASE 6
		;尻は使っているわけではないが届かないので２を返す
		RETURN 2
ENDSELECT

@MODETYPE_後背位(ARG, ARGS)
;0=ペニス 1=クリ 2=指（手） 3=口 4=胸 5=膣 6=アナル
;挿入で使用するのはペニスと膣で1を返す
SELECTCASE ARG
	CASE 0
		SIF ARGS == "プレイヤー"
			RETURN 1
	CASE 3
		;口は届かない
		RETURN 2
	CASE 4
		;プレイヤーの胸は届かない
		SIF ARGS == "プレイヤー"
			RETURN 2
	CASE 5
		SIF ARGS == "ターゲット"
			RETURN 1
		SIF ARGS == "プレイヤー"
			RETURN 2
	CASE 6
		;プレイヤーの尻は届かない
		SIF ARGS == "プレイヤー"
			RETURN 2
ENDSELECT

@MODETYPE_寝バック(ARG, ARGS)
;0=ペニス 1=クリ 2=指（手） 3=口 4=胸 5=膣 6=アナル
;挿入で使用するのはペニスと膣で1を返す
SELECTCASE ARG
	CASE 0
		SIF ARGS == "プレイヤー"
			RETURN 1
		SIF ARGS == "ターゲット"
			RETURN 2
	CASE 1
		;クリは届かない
		SIF ARGS == "ターゲット"
			RETURN 2
	CASE 3
		;口は届かない
		RETURN 2
	CASE 4
		;胸は届かない
		RETURN 2
	CASE 5
		SIF ARGS == "ターゲット"
			RETURN 1
		SIF ARGS == "プレイヤー"
			RETURN 2
	CASE 6
		;プレイヤーの尻は届かない
		SIF ARGS == "プレイヤー"
			RETURN 2
ENDSELECT

@MODETYPE_対面座位(ARG, ARGS)
;0=ペニス 1=クリ 2=指（手） 3=口 4=胸 5=膣 6=アナル
;挿入で使用するのはペニスと膣で1を返す
SELECTCASE ARG
	CASE 0
		SIF ARGS == "プレイヤー"
			RETURN 1
	CASE 3
		;両方ハーヴィンだと口は届く
		SIF TALENT:PLAYER:種族 == 4 && TALENT:TARGET:種族 == 4
			RETURN 0
		;どっちかがハーヴィンだと口は届かない
		SIF TALENT:PLAYER:種族 == 4 || TALENT:TARGET:種族 == 4
			RETURN 2
	CASE 5
		SIF ARGS == "ターゲット"
			RETURN 1
		SIF ARGS == "プレイヤー"
			RETURN 2
	CASE 6
		;プレイヤーの尻は届かない
		SIF ARGS == "プレイヤー"
			RETURN 2
ENDSELECT

@MODETYPE_背面座位(ARG, ARGS)
;0=ペニス 1=クリ 2=指（手） 3=口 4=胸 5=膣 6=アナル
;挿入で使用するのはペニスと膣で1を返す
SELECTCASE ARG
	CASE 0
		SIF ARGS == "プレイヤー"
			RETURN 1
	CASE 3
		;口は届かない
		RETURN 2
	CASE 4
		;プレイヤーの胸は届かない
		SIF ARGS == "プレイヤー"
			RETURN 2
	CASE 5
		SIF ARGS == "ターゲット"
			RETURN 1
		SIF ARGS == "プレイヤー"
			RETURN 2
	CASE 6
		;尻は届かない
		RETURN 2
ENDSELECT

@MODETYPE_騎乗位(ARG, ARGS)
;0=ペニス 1=クリ 2=指（手） 3=口 4=胸 5=膣 6=アナル
;挿入で使用するのはペニスと膣で1を返す
SELECTCASE ARG
	CASE 0
		SIF ARGS == "プレイヤー"
			RETURN 1
	CASE 3
		;両方ハーヴィンだと口は届く
		SIF TALENT:PLAYER:種族 == 4 && TALENT:TARGET:種族 == 4
			RETURN 0
		;どっちかがハーヴィンだと口は届かない
		SIF TALENT:PLAYER:種族 == 4 || TALENT:TARGET:種族 == 4
			RETURN 2
	CASE 5
		SIF ARGS == "ターゲット"
			RETURN 1
		SIF ARGS == "プレイヤー"
			RETURN 2
	CASE 6
		;尻は届かない
		RETURN 2
ENDSELECT

@MODETYPE_側位(ARG, ARGS)
;0=ペニス 1=クリ 2=指（手） 3=口 4=胸 5=膣 6=アナル
;挿入で使用するのはペニスと膣で1を返す
SELECTCASE ARG
	CASE 0
		SIF ARGS == "プレイヤー"
			RETURN 1
	CASE 3
		;口は届かない
		RETURN 2
	CASE 4
		;受け側がハーヴィンなら届く
		SIF ARGS == "ターゲット" && TALENT:TARGET:種族 == 4
			RETURN 0
		;胸は届かない
		RETURN 2
	CASE 5
		SIF ARGS == "ターゲット"
			RETURN 1
		SIF ARGS == "プレイヤー"
			RETURN 2
	CASE 6
		;プレイヤーの尻は届かない
		SIF ARGS == "プレイヤー"
			RETURN 2
ENDSELECT

@MODETYPE_屈曲位(ARG, ARGS)
;0=ペニス 1=クリ 2=指（手） 3=口 4=胸 5=膣 6=アナル
;挿入で使用するのはペニスと膣で1を返す
SELECTCASE ARG
	CASE 0
		SIF ARGS == "プレイヤー"
			RETURN 1
		SIF ARGS == "ターゲット"
			RETURN 2
	CASE 3
		;口は届かない
		RETURN 2
	CASE 5
		SIF ARGS == "ターゲット"
			RETURN 1
		SIF ARGS == "プレイヤー"
			RETURN 2
	CASE 6
		;尻は届かない
		RETURN 2
ENDSELECT

@MODETYPE_駅弁(ARG, ARGS)
;0=ペニス 1=クリ 2=指（手） 3=口 4=胸 5=膣 6=アナル
;挿入で使用するのはペニスと膣で1を返す
SELECTCASE ARG
	CASE 0
		SIF ARGS == "プレイヤー"
			RETURN 1
	CASE 2
		;抱えるので手は使用中
		SIF ARGS == "プレイヤー"
			RETURN 1
	CASE 5
		SIF ARGS == "ターゲット"
			RETURN 1
		SIF ARGS == "プレイヤー"
			RETURN 2
	CASE 6
		;尻は届かない
		RETURN 2
ENDSELECT

@MODETYPE_逆駅弁(ARG, ARGS)
;0=ペニス 1=クリ 2=指（手） 3=口 4=胸 5=膣 6=アナル
;挿入で使用するのはペニスと膣で1を返す
SELECTCASE ARG
	CASE 0
		SIF ARGS == "プレイヤー"
			RETURN 1
	CASE 2
		;抱えるので手は使用中
		SIF ARGS == "プレイヤー"
			RETURN 1
	CASE 3
		;口は届かない
		RETURN 2
	CASE 4
		;胸は届かない
		RETURN 2
	CASE 5
		SIF ARGS == "ターゲット"
			RETURN 1
		SIF ARGS == "プレイヤー"
			RETURN 2
	CASE 6
		;尻は届かない
		RETURN 2
ENDSELECT

@MODETYPE_対面立位(ARG, ARGS)
;0=ペニス 1=クリ 2=指（手） 3=口 4=胸 5=膣 6=アナル
;挿入で使用するのはペニスと膣で1を返す
SELECTCASE ARG
	CASE 0
		SIF ARGS == "プレイヤー"
			RETURN 1
	CASE 5
		SIF ARGS == "ターゲット"
			RETURN 1
		SIF ARGS == "プレイヤー"
			RETURN 2
ENDSELECT

@MODETYPE_立ちバック(ARG, ARGS)
;0=ペニス 1=クリ 2=指（手） 3=口 4=胸 5=膣 6=アナル
;挿入で使用するのはペニスと膣で1を返す
SELECTCASE ARG
	CASE 0
		SIF ARGS == "プレイヤー"
			RETURN 1
	CASE 3
		;口は届かない
		RETURN 2
	CASE 4
		;プレイヤーの胸は届かない
		SIF ARGS == "プレイヤー"
			RETURN 2
	CASE 5
		SIF ARGS == "ターゲット"
			RETURN 1
		SIF ARGS == "プレイヤー"
			RETURN 2
	CASE 6
		;プレイヤーの尻は届かない
		SIF ARGS == "プレイヤー"
			RETURN 2
ENDSELECT

@MODETYPE_同時挿入(ARG, ARGS)
;0=ペニス 1=クリ 2=指（手） 3=口 4=胸 5=膣 6=アナル
;挿入で使用するのはペニスと膣で1を返す
SELECTCASE ARG
	CASE 0
		SIF ARGS == "プレイヤー"
			RETURN 1
	CASE 5
		SIF ARGS == "ターゲット"
			RETURN 1
		SIF ARGS == "プレイヤー"
			RETURN 2
ENDSELECT
