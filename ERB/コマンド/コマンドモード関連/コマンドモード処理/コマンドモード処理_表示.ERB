;-------------------------------------------------------------------------------------------
;モード表示や設定表示などの関数群
;-------------------------------------------------------------------------------------------
@SHOW_MODE()
#DIM 配列番号
#DIM 配列番号受け渡し
#DIM 最大番号
#DIM モード数カウント
#DIM 実行キャラ番号
#DIM 対象キャラ番号
#DIMS 実行モード名
#DIM 優先度計算
#DIM ソート用配列_優先度, 体位モード上限
#DIM ソート用配列_配列番号, 体位モード上限
#DIM CONST 表示上限 = 10

モード数カウント = 0
VARSET ソート用配列_優先度
VARSET ソート用配列_配列番号

;モードに優先度を付けて配列へ格納
;昇順ソートのため負数で優先度を付ける
FOR 配列番号, 0, DT_ROW_LENGTH("体位モードデータベース")
	実行キャラ番号 = DT_CELL_GET("体位モードデータベース", 配列番号, "実行キャラ")
	対象キャラ番号 = DT_CELL_GET("体位モードデータベース", 配列番号, "対象キャラ")
	SIF !IS_SAME_ROOM(PLAYER, 対象キャラ番号)
		CONTINUE
	優先度計算 = 配列番号 - 1000
	SIF 実行キャラ番号 == PLAYER
		優先度計算 -= 200000
	SIF 対象キャラ番号 == PLAYER
		優先度計算 -= 100000
	SIF 実行キャラ番号 == TARGET
		優先度計算 -= 20000
	SIF 対象キャラ番号 == TARGET
		優先度計算 -= 10000
	ソート用配列_優先度:モード数カウント = 優先度計算
	ソート用配列_配列番号:モード数カウント = 配列番号
	モード数カウント++
NEXT

ARRAYMSORT ソート用配列_優先度, ソート用配列_配列番号

SIF モード数カウント > 0
	DRAWLINE

;優先度の高いモードから順に表示上限まで表示
IF MODE全表示フラグ
	最大番号 = モード数カウント
ELSE
	最大番号 = MIN(モード数カウント, 表示上限)
ENDIF
FOR 配列番号, 0, 最大番号
	配列番号受け渡し = ソート用配列_配列番号:配列番号
	実行キャラ番号 = DT_CELL_GET("体位モードデータベース", (配列番号受け渡し), "実行キャラ")
	対象キャラ番号 = DT_CELL_GET("体位モードデータベース", (配列番号受け渡し), "対象キャラ")
	実行モード名 = %DT_CELL_GETS("体位モードデータベース", (配列番号受け渡し), "モード名")%

	SETCOLOR カラーパレット("えっちな色")
	IF 系統リスト_アイテム系(実行モード名)
		PRINTFORM [%CALLNAME:対象キャラ番号%が%実行モード名%装着中
	ELSEIF 系統リスト_触手系(実行モード名)
		PRINTFORM [触手が%CALLNAME:対象キャラ番号%に%実行モード名%中
	ELSEIF 系統リスト_自慰系(実行モード名)
		PRINTFORM [%CALLNAME:対象キャラ番号%が%実行モード名%中
	ELSE
		PRINTFORM [%CALLNAME:実行キャラ番号%が%CALLNAME:対象キャラ番号%に%実行モード名%中
	ENDIF
	PRINT_IMG "えっちハート"
	PRINT ]
	RESETCOLOR
	IF 系統リスト_ハーヴィンオナホ系(実行モード名) == 0 && 実行モード名 != "全裸散歩"
		PRINTBUTTON "[✕]", @"モード中断_{配列番号受け渡し}"
	ENDIF
	CALL MODE詳細設定処理(対象キャラ番号, 実行モード名, 実行キャラ番号)
	PRINTL 
NEXT

IF 表示上限 < モード数カウント
	IF MODE全表示フラグ == 0
		PRINTFORM 他{モード数カウント - 表示上限, 2}件　　
		PRINTBUTTON "[全表示]", "モード全表示"
		PRINTL
	ELSE
		PRINTBUTTON "[省略表示]", "モード全表示"
		PRINTL
	ENDIF
ENDIF


@MODE詳細設定処理(対象キャラ番号, 体位モード, 実行キャラ番号)
#DIM 対象キャラ番号
#DIM 実行キャラ番号
#DIM 判定数値保存
#DIMS 体位モード

IF 実行キャラ番号 == PLAYER
	IF MODE系統確認(体位モード, "Ｖ挿入系")
		PRINT 　　Ｖ挿入強さ：
		PRINTBUTTON "[-]", @"MODE詳細設定処理_V挿入強さ_{対象キャラ番号}_下降"
		FOR LOCAL, 0, 6
			IF V挿入強さ:対象キャラ番号:0 >= LOCAL
				PRINTBUTTON "■", @"MODE詳細設定処理_V挿入強さ_{対象キャラ番号}_{LOCAL}"
			ELSE
				PRINTBUTTON "□", @"MODE詳細設定処理_V挿入強さ_{対象キャラ番号}_{LOCAL}"
			ENDIF
		NEXT
		PRINTBUTTON "[+]", @"MODE詳細設定処理_V挿入強さ_{対象キャラ番号}_上昇"
		PRINT 　　
		PRINT Ｖ挿入速さ：
		PRINTBUTTON "[-]", @"MODE詳細設定処理_V挿入速さ_{対象キャラ番号}_下降"
		FOR LOCAL, 0, 6
			IF V挿入速さ:対象キャラ番号:0 >= LOCAL
				PRINTBUTTON "■", @"MODE詳細設定処理_V挿入速さ_{対象キャラ番号}_{LOCAL}"
			ELSE
				PRINTBUTTON "□", @"MODE詳細設定処理_V挿入速さ_{対象キャラ番号}_{LOCAL}"
			ENDIF
		NEXT
		PRINTBUTTON "[+]", @"MODE詳細設定処理_V挿入速さ_{対象キャラ番号}_上昇"
	ENDIF
	IF MODE系統確認(体位モード, "Ａ挿入系")
		PRINT 　　Ａ挿入強さ：
		PRINTBUTTON "[-]", @"MODE詳細設定処理_A挿入強さ_{対象キャラ番号}_下降"
		FOR LOCAL, 0, 6
			IF A挿入強さ:対象キャラ番号:0 >= LOCAL
				PRINTBUTTON "■", @"MODE詳細設定処理_A挿入強さ_{対象キャラ番号}_{LOCAL}"
			ELSE
				PRINTBUTTON "□", @"MODE詳細設定処理_A挿入強さ_{対象キャラ番号}_{LOCAL}"
			ENDIF
		NEXT
		PRINTBUTTON "[+]", @"MODE詳細設定処理_A挿入強さ_{対象キャラ番号}_上昇"
		PRINT 　　
		PRINT Ａ挿入速さ：
		PRINTBUTTON "[-]", @"MODE詳細設定処理_A挿入速さ_{対象キャラ番号}_下降"
		FOR LOCAL, 0, 6
			IF A挿入速さ:対象キャラ番号:0 >= LOCAL
				PRINTBUTTON "■", @"MODE詳細設定処理_A挿入速さ_{対象キャラ番号}_{LOCAL}"
			ELSE
				PRINTBUTTON "□", @"MODE詳細設定処理_A挿入速さ_{対象キャラ番号}_{LOCAL}"
			ENDIF
		NEXT
		PRINTBUTTON "[+]", @"MODE詳細設定処理_A挿入速さ_{対象キャラ番号}_上昇"
	ENDIF
ELSE
	IF MODE系統確認(体位モード, "Ｖ挿入系")
		PRINT 　　Ｖ挿入強さ：   
		FOR LOCAL, 0, 6
			IF V挿入強さ:対象キャラ番号:0 >= LOCAL
				PRINT ■
			ELSE
				PRINT □
			ENDIF
		NEXT
		PRINT 　   　
		PRINT Ｖ挿入速さ：   
		FOR LOCAL, 0, 6
			IF V挿入速さ:対象キャラ番号:0 >= LOCAL
				PRINT ■
			ELSE
				PRINT □
			ENDIF
		NEXT
	ENDIF
	IF MODE系統確認(体位モード, "Ａ挿入系")
		PRINT 　　Ａ挿入強さ：   
		FOR LOCAL, 0, 6
			IF A挿入強さ:対象キャラ番号:0 >= LOCAL
				PRINT ■
			ELSE
				PRINT □
			ENDIF
		NEXT
		PRINT 　   　
		PRINT Ａ挿入速さ：   
		FOR LOCAL, 0, 6
			IF A挿入速さ:対象キャラ番号:0 >= LOCAL
				PRINT ■
			ELSE
				PRINT □
			ENDIF
		NEXT
	ENDIF
ENDIF
IF 実行キャラ番号 == PLAYER || 対象キャラ番号 == PLAYER
	IF 系統リスト_アイテム系(体位モード) && 体位モード != "アナルビーズ" && 体位モード != "ペニスバンド"
		PRINTFORM 　　%体位モード%強さ：
		PRINTBUTTON "[-]", @"MODE詳細設定処理_%体位モード%強さ_{対象キャラ番号}_下降"
		判定数値保存 = GETVAR(@"%体位モード%強さ:{対象キャラ番号}:0")
		FOR LOCAL, 0, 6
			IF 判定数値保存 >= LOCAL
				PRINTBUTTON "■", @"MODE詳細設定処理_%体位モード%強さ_{対象キャラ番号}_{LOCAL}"
			ELSE
				PRINTBUTTON "□", @"MODE詳細設定処理_%体位モード%強さ_{対象キャラ番号}_{LOCAL}"
			ENDIF
		NEXT
		PRINTBUTTON "[+]", @"MODE詳細設定処理_%体位モード%強さ_{対象キャラ番号}_上昇"
	ENDIF
ELSE
	IF 系統リスト_アイテム系(体位モード) && 体位モード != "アナルビーズ" && 体位モード != "ペニスバンド"
		PRINTFORM 　　%体位モード%強さ：   
		判定数値保存 = GETVAR(@"%体位モード%強さ:{対象キャラ番号}:0")
		FOR LOCAL, 0, 6
			IF 判定数値保存 >= LOCAL
				PRINT ■
			ELSE
				PRINT □
			ENDIF
		NEXT
	ENDIF
ENDIF
