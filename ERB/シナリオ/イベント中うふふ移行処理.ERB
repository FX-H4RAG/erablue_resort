
@イベント中うふふ移行処理()
#DIM 現在位置保存, 100
#DIM 現在マップ種別保存, 100

VARSET 現在位置保存, 2000
VARSET 現在マップ種別保存

SAVESTR:ゲームフェイズ管理 = 通常モード

CFLAG:MASTER:うふふ = 1

SWAP CFLAG:MASTER:現在位置, 現在位置保存:0
SWAP CFLAG:MASTER:現在マップ種別, 現在マップ種別保存:0

LOCAL:1 = 1
FOR LOCAL, 1, CHARANUM
	SIF RCVAR:LOCAL:イベントうふふ対象フラグ == 0
		CONTINUE
	SWAP CFLAG:LOCAL:現在位置, 現在位置保存:(LOCAL:1)
	SWAP CFLAG:LOCAL:現在マップ種別, 現在マップ種別保存:(LOCAL:1)
	CFLAG:LOCAL:うふふ = 1
	CFLAG:LOCAL:睡眠 = 0
	CFLAG:LOCAL:同室 = 1
	LOCAL:1 ++
NEXT

FLAG:イベントTIME記録 = 0
;処理の誤爆を防ぐためオートコマンド周りリセット
TFLAG:オートコマンドフラグ = 0
AUTOCOM_相手番号保存 = 0
自慰ターゲット保存 = 0

CALL SORT_CFLAG(21)
CALL TRAIN_イベントうふふ_LOOP()

SWAP CFLAG:MASTER:現在位置, 現在位置保存:0
SWAP CFLAG:MASTER:現在マップ種別, 現在マップ種別保存:0

LOCAL:1 = 1
FOR LOCAL, 1, CHARANUM
	SIF RCVAR:LOCAL:イベントうふふ対象フラグ == 0
		CONTINUE
	SWAP CFLAG:LOCAL:現在位置, 現在位置保存:(LOCAL:1)
	SWAP CFLAG:LOCAL:現在マップ種別, 現在マップ種別保存:(LOCAL:1)
	CFLAG:LOCAL:同室 = 0
	CFLAG:LOCAL:睡眠 = 1
	RCVAR:LOCAL:イベントうふふ対象フラグ = 0
	LOCAL:1 ++
NEXT
