;-------------------------------------------------
;勃起おしゃぶりエステ
;-------------------------------------------------
@MASSAGE_COMNAME31
#FUNCTIONS
TSTR:コマンド名受渡 = 勃起おしゃぶりエステ


;===================================================
;コマンドタイプ
;===================================================
@MASSAGE_COMTYPE_31
#FUNCTION
TFLAG:コマンドタイプ受渡 = COMTYPE("エロマッサージ")

@MASSAGE_COM_TOOLTIP_31
LOCALS = <br>■勃起おしゃぶりエステ<br>
LOCALS += "フェラモードには突入しない単発コマンド。"
LOCALS += "マッサージ中にカチカチに『凝って』しまったペニスを、おくちでマッサージしてあげる。"
LOCALS += "<br>COMタイプ：エロマッサージ<br>取得ソース：快Ｃ・露出・接触・奉仕(PLAYER)・不潔(PLAYER)"
LOCALS += "<br>固有の取得経験：なし<br>"
TSTR:ツールチップ受渡 = %LOCALS%

@MASSAGE_COM31
;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------

;基盤ができたあとで理性を削る処理を入れる

;フェラからだいたいそのまま持ってきた
CALL SOURCE_CALC_快Ｃ(TARGET, PLAYER, 150)
CALL SOURCE_CALC_露出(TARGET, PLAYER, 30)
CALL SOURCE_CALC_接触(TARGET, PLAYER, 120)

;舌使いによって、快感のソース増加
IF TALENT:PLAYER:舌使い
	CALL SOURCE_CALC_快Ｃ(TARGET, PLAYER, 150)
ENDIF

;猫舌では苦痛ちょいある
SIF TALENT:PLAYER:猫舌
	CALL SOURCE_CALC_苦痛(TARGET, PLAYER, 20)

CALL SOURCE_CALC_奉仕(PLAYER, TARGET, 300)
CALL SOURCE_CALC_不潔(PLAYER, TARGET, 250)



;下半身下着がある場合は脱がす。
IF TEQUIP:下半身下着あり == 1
	TEQUIP:下半身下着あり = 0
	RFLAG:コマンド結果受渡し変数 = 1
ENDIF
;-------------------------------------------------
;経験の処理
;-------------------------------------------------

RETURN 1

;-------------------------------------------------
;実行判定
;-------------------------------------------------

@MASSAGE_COM_ABLE31
SIF SAVESTR:ゲームフェイズ管理 != "マッサージモード"
	RETURN 0

;相手がオトコか半人半妖かふたなりじゃないとダメ
SIF !(TALENT:TARGET:性別 & 2)
	RETURN 0
;相手にちんこがない場合駄目
SIF TALENT:TARGET:Ｃ感度 == -2
	RETURN 0

;相手のちんぽが『凝って』ないとダメ
SIF BASE:TARGET:勃起 < 1000
	RETURN 0

;うつ伏せだとダメ
SIF TCVAR:TARGET:マッサージ_うつ伏せフラグ == 1
	RETURN 0


RETURN 1

;-------------------------------------------------
;実行時メッセージ
;-------------------------------------------------
@MASSAGE_MESSAGE_COM31

PRINTFORM %CALLNAME:PLAYER%は、

	IF RFLAG:コマンド結果受渡し変数 == 1
		PRINTFORM %CALLNAME:TARGET%の
			;Ｖがあり欲情している場合
			SIF TALENT:TARGET:Ｖ感度 >= -1 && PALAM:欲情  >= PALAMLV:3
			 	PRINTFORM ぐっしょりと愛液を吸った
		PRINTFORM 施術着を脱がし、
	ENDIF
	
PRINTFORM %CALLNAME:TARGET%の

	;巨根以上
	IF TALENT:TARGET:男性器サイズ >= 1
			PRINTFORM バキバキに勃起した%TEXTR("デカちんぽ/巨根")%
		ELSEIF TALENT:TARGET:男性器サイズ <= -1
		;短小以下
			PRINTFORM カチカチに硬くなったひとくちサイズの%TEXTR("ちんちん/おちんちん/ペニス")%
		ELSE
		;普通サイズ
			PRINTFORM ガチガチに勃起した%TEXTR("肉棒/ちんぽ")%
		ENDIF
		PRINTFORML を、%TEXTR("唾液たっぷりのおくち/舌で唾液をたっぷり塗りこん")%で『エステ』してあげた。

