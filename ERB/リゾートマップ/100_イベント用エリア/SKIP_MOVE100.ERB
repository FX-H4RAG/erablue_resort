
;-----------------------------------------------------------
;遠距離移動処理
;-----------------------------------------------------------

@SKIP_MOVE_100(ARG, ARG:1)
;ARG　目的地
;ARG:1　移動キャラID

;個別のお祭り関数を呼ぶ
CALLFORM SKIP_MOVE_100_%開催予定祭り名%(ARG, ARG:1)
RETURN RESULT



@SKIP_MOVE_100_FESTIVAL_お花見(ARG, ARG:1)
#DIM スタート地点
#DIM スタートマップ
#DIM 目的マップ
#DIM 移動キャラ = 0

;現在位置取得
移動キャラ = 0
スタート地点 = CFLAG:MASTER:現在位置
IF ARG:1
	移動キャラ = ARG:1
	スタート地点 = CFLAG:移動キャラ:現在位置
ENDIF

$LOOP

;暫定目的地に直接移動できる場合
IF CAN_MOVE_1(CFLAG:移動キャラ:現在マップ種別, スタート地点, ARG) & 1
	;そこに移動
	RETURN ARG
ENDIF

;袋小路から行ける場所は固定なので、そこを目指す
SELECTCASE スタート地点
	CASE 6
		RETURN 3
ENDSELECT

;直接移動できない場合、1つ近い位置を暫定目的地に設定し直してループ
;地点追加時要フォロー（全ケース修正すること）
SELECTCASE ARG
	CASE 6
	;静かな場所へは宴会場経由
		RETURN 3
ENDSELECT
GOTO LOOP
