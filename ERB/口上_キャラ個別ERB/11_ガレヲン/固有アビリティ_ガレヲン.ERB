
@固有アビ_11_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIM バフ・デバフ行数
#DIM 隊列番号
#DIMS アビ名

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
	アビ名 = 祝福の接吻＋
	消費ＭＰ = 200
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 5
	アビ名 = 祝福の接吻
	消費ＭＰ = 200
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>味方単体に巌迫の祝福効果
			詳細文文字列受け渡し変数 += @"<br>〇巌迫の祝福［独自枠/永続/消去不可］"
			詳細文文字列受け渡し変数 += @"<br>　対象の攻撃性能/防御性能を上昇"
			詳細文文字列受け渡し変数 += @"<br>◆対象に厳迫の祝福が付与されている時、ＨＰを［500］回復"
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 5
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>味方単体に巌迫の祝福効果
			詳細文文字列受け渡し変数 += @"<br>〇巌迫の祝福［独自枠/永続/消去不可］"
			詳細文文字列受け渡し変数 += @"<br>　対象の攻撃性能/防御性能を上昇"
		ENDIF
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_味方単体_生者のみ
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
			隊列番号 = アビテンプレート用_対象保存:0
			バフ・デバフ行数 = バフ存在チェック_枠("巌迫の祝福_土強化", 隊列番号) 
			IF バフ・デバフ行数 > -1
				アビ汎用変数:効果量 = 500
				CALL アビテンプレート_回復処理_MAXでも回復
				
				CALL アビ汎用変数文字列リセット
			ENDIF
		ENDIF
		アビ汎用変数:効果量 = 50
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 巌迫の祝福_土強化
		アビ汎用文字列:バフ・デバフ対象能力 = 土強化
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_バフ効果セット

		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果割合 = 100
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 巌迫の祝福_防御力
		アビ汎用文字列:バフ・デバフ対象能力 = 防御力
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果量 = 100
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 巌迫の祝福_DA率
		アビ汎用文字列:バフ・デバフ対象能力 = DA率
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果量 = 0
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 巌迫の祝福_弱体無効
		アビ汎用文字列:バフ・デバフ対象能力 = 弱体無効
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果割合 = 20
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 巌迫の祝福_追撃
		アビ汎用文字列:バフ・デバフ対象能力 = 追撃
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_バフ効果セット
ENDSELECT


@固有アビ_11_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 13
	アビ名 = 降砂岩＋
	消費ＭＰ = 80
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 7
	アビ名 = 降砂岩
	消費ＭＰ = 100
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>ターゲットに関わらず6回土属性［攻撃力✕66％］ダメージ
		詳細文文字列受け渡し変数 += @"<br>敵全体にスロウ効果［1回/基礎成功確率100％］"
		詳細文文字列受け渡し変数 += @"<br>敵全体の強化効果を消去［1回］"
		詳細文文字列受け渡し変数 += @"<br>◆『金』の楔石効果中、4の倍数ターン終了時に自動発動"
	RETURN 消費ＭＰ
	CASE "アビ効果"
		FOR LOCAL, 0, 6
			CALL アビ対象選択テンプレート_敵ランダムＸ体(1)
			アビ汎用変数:敵対心無視オプション = 1
			アビ汎用変数:効果割合 = 66
			CALL アビテンプレート_ダメージ処理_土属性
		NEXT
		
		CALL アビ対象選択テンプレート_敵全体_生者のみ
		アビ汎用変数:効果量 = 1
		アビ汎用変数:基礎成功確率 = 100
		CALL アビテンプレート_不利効果_スロウ
		
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果量 = 1
		CALL アビテンプレート_不利効果_バフ消去
ENDSELECT

@固有アビ_11_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 効果数値

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 30
	アビ名 = 『金』の楔石
	消費ＭＰ = 500
ENDIF

SIF 戦闘中カウント:戦闘行動キャラ:0
	アビテンプレート用_アビ封印用フラグ = 1

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>自身に『金』の楔石効果［再使用不可］
		詳細文文字列受け渡し変数 += @"<br>〇『金』の楔石［独自枠/永続/消去不可］"
		詳細文文字列受け渡し変数 += @"<br>　自身の攻撃性能/防御性能を大幅に上昇"
		詳細文文字列受け渡し変数 += @"<br>　奇数ターン中行動不能になるが、偶数ターンに与ダメージ・奥義ゲージが上昇"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用変数:効果割合 = 100
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 『金』の楔石_攻撃力
		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果割合 = 300
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 『金』の楔石_防御力
		アビ汎用文字列:バフ・デバフ対象能力 = 防御力
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果量 = 100
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 『金』の楔石_TA率
		アビ汎用文字列:バフ・デバフ対象能力 = TA率
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_バフ効果セット

		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果量 = 0
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 『金』の楔石_弱体無効
		アビ汎用文字列:バフ・デバフ対象能力 = 弱体無効
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果量 = 0
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 『金』の楔石
		アビ汎用文字列:バフ・デバフ対象能力 = 『金』の楔石
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		戦闘中カウント:戦闘行動キャラ:0 = 1
ENDSELECT

@固有ターン開始時処理_キャラ_11
;ターン開始時処理関数から呼び出し
#DIM バフ・デバフ行数
#DIM 隊列番号

隊列番号 = キャラ隊列検索(FINDCHARA(NO, 11))

バフ・デバフ行数 = バフ存在チェック_枠("『金』の楔石", 隊列番号)
IF バフ・デバフ行数 > -1
	IF 現在ターン数 % 2 == 1
		WSTR:(K++) = ガレヲンは静かに佇んでいる…
		行動不能フラグ = 1
	ELSEIF 現在ターン数 % 2 == 0
		WSTR:(K++) = 母なる大地の仁愛が隆起する…
		アビテンプレート用_アビ名 = 『金』の楔石
		
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用変数:効果割合 = 150
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 母なる大地の仁愛
		アビ汎用文字列:バフ・デバフ対象能力 = 与ダメ増加
		アビ汎用変数:持続ターン = 1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果量 = 20
		CALL アビテンプレート_有利効果_奥義ゲージUP
	ENDIF
ENDIF


@固有ターン終了時処理_キャラ_11
;降砂岩自動発動処理
;ターン終了時処理関数から呼び出し
#DIM バフ・デバフ行数
#DIM 隊列番号

隊列番号 = キャラ隊列検索(FINDCHARA(NO, 11))

バフ・デバフ行数 = バフ存在チェック_枠("『金』の楔石", 隊列番号)
IF バフ・デバフ行数 > -1
	IF 現在ターン数 % 4 == 0
		WSTR:(K++) = 《破潰。（usubut…）》
		アビテンプレート用_アビ名 = 降砂岩
		
		FOR LOCAL, 0, 6
			CALL アビ対象選択テンプレート_敵ランダムＸ体(1)
			アビ汎用変数:敵対心無視オプション = 1
			アビ汎用変数:効果割合 = 66
			CALL アビテンプレート_ダメージ処理_土属性
		NEXT
		
		CALL アビ対象選択テンプレート_敵全体_生者のみ
		アビ汎用変数:効果量 = 1
		アビ汎用変数:基礎成功確率 = 100
		CALL アビテンプレート_不利効果_スロウ
		
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果量 = 1
		CALL アビテンプレート_不利効果_バフ消去
	ENDIF
ENDIF

