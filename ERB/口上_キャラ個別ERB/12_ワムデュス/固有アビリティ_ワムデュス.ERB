
@固有アビ_12_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
	アビ名 = ヴォーテクスアトラクター＋
	消費ＭＰ = 50
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 5
	アビ名 = ヴォーテクスアトラクター
	消費ＭＰ = 50
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>◆ワム、おなか空いた……「つよくなるやつ」、いっぱい吸い込む
			詳細文文字列受け渡し変数 += @"<br>　敵味方全体の強化効果を消去［5回］"
			詳細文文字列受け渡し変数 += @"<br>　自身にテンタクル・フォース効果［2ターン/消去不可］"
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 5
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>◆ワム、おなか空いた……「つよくなるやつ」、ほどほどに吸い込む
			詳細文文字列受け渡し変数 += @"<br>　敵味方全体の強化効果を消去［3回］"
			詳細文文字列受け渡し変数 += @"<br>　自身にテンタクル・フォース効果［2ターン/消去不可］"
		ENDIF
		RETURN 消費ＭＰ
	CASE "アビ効果"
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
			CALL アビ対象選択テンプレート_敵全体_生者のみ
			アビ汎用変数:効果量 = 5
			CALL アビテンプレート_不利効果_バフ消去
			
			CALL アビ対象選択テンプレート_味方全体_生者のみ
			アビ汎用変数:効果量 = 5
			CALL アビテンプレート_不利効果_バフ消去
		ENDIF
		
		IF 基礎BATTLE_STATE:キャラ番号:Lv < 20
			CALL アビ対象選択テンプレート_敵全体_生者のみ
			アビ汎用変数:効果量 = 3
			CALL アビテンプレート_不利効果_バフ消去
			
			CALL アビ対象選択テンプレート_味方全体_生者のみ
			アビ汎用変数:効果量 = 3
			CALL アビテンプレート_不利効果_バフ消去
		ENDIF
		
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用変数:効果割合 = 50
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 通常攻撃ダメージ補正_割合_T・F
		アビ汎用文字列:バフ・デバフ対象能力 = 通常攻撃ダメージ補正_割合
		アビ汎用変数:持続ターン = 2
		CALL アビテンプレート_有利効果_バフ効果セット

		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果量 = 100
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = TA率_T・F
		アビ汎用文字列:バフ・デバフ対象能力 = TA率
		アビ汎用変数:持続ターン = 2
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果割合 = 100
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 追撃_T・F
		アビ汎用文字列:バフ・デバフ対象能力 = 追撃
		アビ汎用変数:持続ターン = 2
		CALL アビテンプレート_有利効果_バフ効果セット
ENDSELECT


@固有アビ_12_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 13
	アビ名 = イノセントトキシン＋
	消費ＭＰ = 75
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 7
	アビ名 = イノセントトキシン
	消費ＭＰ = 100
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に6回水属性の［攻撃力✕150％］ダメージ
		詳細文文字列受け渡し変数 += @"<br>対象に麻痺効果［個人枠/2ターン/基礎成功確率90％］"
		詳細文文字列受け渡し変数 += @"<br>対象に猛毒効果［50/最大500/永続/基礎成功確率100％］"
		詳細文文字列受け渡し変数 += @"<br>◆ダメージを受けた時、1ターンに1回のみ自動発動"
	RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_敵単体
		アビ汎用変数:効果割合 = 150
		FOR LOCAL, 0, 6
			CALL アビテンプレート_ダメージ処理_水属性
		NEXT
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 麻痺_個人枠
		アビ汎用文字列:バフ・デバフ対象能力 = 麻痺
		アビ汎用変数:効果割合 = 100
		アビ汎用変数:持続ターン = 2
		アビ汎用変数:基礎成功確率 = 90
		CALL アビテンプレート_不利効果_デバフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 猛毒
		アビ汎用文字列:バフ・デバフ対象能力 = 毒
		アビ汎用変数:効果量 = 50
		アビ汎用変数:累積上限_割合 = 500
		アビ汎用変数:持続ターン = -1
		アビ汎用変数:基礎成功確率 = 100
		CALL アビテンプレート_不利効果_累積デバフ効果セット
ENDSELECT

@固有戦闘開始時処理_キャラ_12
;戦闘開始時処理関数から呼び出し
#DIM バフ・デバフ行数
#DIM 隊列番号

隊列番号 = キャラ隊列検索(FINDCHARA(NO, 12))

バフ・デバフ行数 = バフ存在チェック_枠("イノセントトキシン", 隊列番号)
IF バフ・デバフ行数 < 0
	アビテンプレート用_アビ名 = イノセントトキシン
	
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:消去不可オプション = 1
	アビ汎用文字列:バフ・デバフ枠 = イノセントトキシン
	アビ汎用文字列:バフ・デバフ対象能力 = 特殊反応_被ダメ時
	アビ汎用変数:持続回数 = 1
	CALL アビテンプレート_有利効果_バフ効果セット
ENDIF

@固有ターン開始時処理_キャラ_12
;ターン開始時処理関数から呼び出し
#DIM バフ・デバフ行数
#DIM 隊列番号

隊列番号 = キャラ隊列検索(FINDCHARA(NO, 12))

バフ・デバフ行数 = バフ存在チェック_枠("イノセントトキシン", 隊列番号)
IF バフ・デバフ行数 < 0
	アビテンプレート用_アビ名 = イノセントトキシン
	
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:消去不可オプション = 1
	アビ汎用文字列:バフ・デバフ枠 = イノセントトキシン
	アビ汎用文字列:バフ・デバフ対象能力 = 特殊反応_被ダメ時
	アビ汎用変数:持続回数 = 1
	CALL アビテンプレート_有利効果_バフ効果セット
ENDIF

@特殊反応_被ダメ時_イノセントトキシン(攻撃者隊列, 被ダメ回数)
#DIM 被ダメ回数
#DIM 攻撃者隊列

VARSET アビテンプレート用_対象保存, -1
アビテンプレート用_対象保存:0 = 攻撃者隊列

WSTR:(K++) = 《emuziiis!》
アビテンプレート用_アビ名 = イノセントトキシン

CALL アビ汎用変数文字列リセット
アビ汎用変数:効果割合 = 150
FOR LOCAL, 0, 6
	CALL アビテンプレート_ダメージ処理_水属性
NEXT

CALL アビ汎用変数文字列リセット
アビ汎用文字列:バフ・デバフ枠 = 麻痺_個人枠
アビ汎用文字列:バフ・デバフ対象能力 = 麻痺
アビ汎用変数:効果割合 = 100
アビ汎用変数:持続ターン = 2
アビ汎用変数:基礎成功確率 = 90
CALL アビテンプレート_不利効果_デバフ効果セット

CALL アビ汎用変数文字列リセット
アビ汎用文字列:バフ・デバフ枠 = 猛毒
アビ汎用文字列:バフ・デバフ対象能力 = 毒
アビ汎用変数:効果量 = 50
アビ汎用変数:累積上限_割合 = 500
アビ汎用変数:持続ターン = -1
アビ汎用変数:基礎成功確率 = 100
CALL アビテンプレート_不利効果_累積デバフ効果セット

@固有アビ_12_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 効果数値

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 30
	アビ名 = 『碧』の月暈
	消費ＭＰ = 300
ENDIF

SIF 戦闘中カウント:戦闘行動キャラ:0
	アビテンプレート用_アビ封印用フラグ = 1

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>自身に『碧』の月暈効果[再使用不可]
		詳細文文字列受け渡し変数 += @"<br>〇『碧』の月暈［独自枠/永続/消去不可］"
		詳細文文字列受け渡し変数 += @"<br>　自身の防御性能を大幅に上昇"
		詳細文文字列受け渡し変数 += @"<br>　被ダメージ時の奥義ゲージ上昇量が［200％］上昇"
		詳細文文字列受け渡し変数 += @"<br>　毎ターンHPが［最大HPの5％］回復"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果量 = 0
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 『碧』の月暈
		アビ汎用文字列:バフ・デバフ対象能力 = 『碧』の月暈
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_バフ効果セット

		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用変数:効果割合 = 300
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 『碧』の月暈_防御力
		アビ汎用文字列:バフ・デバフ対象能力 = 防御力
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_バフ効果セット

		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果量 = 0
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 『碧』の月暈_弱体無効
		アビ汎用文字列:バフ・デバフ対象能力 = 弱体無効
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_バフ効果セット

		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果量 = 200
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:バフ・デバフ枠 = 『碧』の月暈_被ダメゲージ
		アビ汎用文字列:バフ・デバフ対象能力 = ゲージ上昇効率_被ダメ時
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_バフ効果セット

		戦闘中カウント:戦闘行動キャラ:0 = 1
ENDSELECT

@固有ターン終了時処理_キャラ_12
;ターン終了時処理関数から呼び出し
#DIM バフ・デバフ行数
#DIM 隊列番号

隊列番号 = キャラ隊列検索(FINDCHARA(NO, 12))

バフ・デバフ行数 = バフ存在チェック_枠("『碧』の月暈", 隊列番号)
IF バフ・デバフ行数 > -1
	WSTR:(K++) = 《eamisettook…》
	アビテンプレート用_アビ名 = 『碧』の月暈
	
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:効果割合 = 5
	アビ汎用文字列:回復側使用能力値 = 最大ＨＰ
	CALL アビテンプレート_回復処理_MAXでも回復
ENDIF

