;--------------------------------------------------
;ダンジョン探索中に条件を満たしていた時表示される文章
;--------------------------------------------------
;・使い方
;「25」をキャラクター番号に置換し、それぞれの関数に処理を入れる
;--------------------------------------------------

;--------------------------------------------------
;「仲間と会話」ボタン押下時
;--------------------------------------------------
@KOJO_DUNGEON_仲間と会話_25(対象キャラ)
#DIM 対象キャラ
;簡単に何度も見られるので、条件分岐やランダム化で複数パターンの登録を推奨
CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

SELECTCASE RAND:3 + RAND:3
	CASE 0
		WSTR:(K++) = 「_I_おいおい、オレ様にばかり見とれてないで周りも警戒しろよ_CALL_カリオストロ本性開示_」
		KSTR:(K++) = %CALLNAME:対象キャラ%は意地の悪そうな笑顔を浮かべている
	CASE 1
		WSTR:(K++) = %CALLNAME:対象キャラ%は周囲を伺っている……
		KSTR:(K++) = 「_I_はてさて、なにか使えそうな素材は……」
	CASE 2
		WSTR:(K++) = 「んー？ %CSTR:対象キャラ:二人称%さん、どぉしたの？」
		KSTR:(K++) = %CALLNAME:対象キャラ%は小首をかしげている
	CASE 3
		WSTR:(K++) = _CALLNAME_は憂いを帯びた表情でため息をついている……
		KSTR:(K++) = 「あ、_2nd_さん、どうだった？ 今の表情、一味違う可愛さだったでしょ♪」
	CASE 4
		WSTR:(K++) = 「_I_おい%CSTR:対象キャラ:二人称%、あんまりオレ様から離れるんじゃねぇぞ_」
		KSTR:(K++) = 「_I_オレ様がついているのに怪我でもされちゃ、沽券に関わるからな_CALL_カリオストロ本性開示_」
ENDSELECT

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ,,0,,対象キャラ)



;--------------------------------------------------
;固有スキル発動時
;--------------------------------------------------
;「（キャラ名）の（アビ名）！」よりも前に表示される
;汎用アビや衣装アビだと発動しないので注意

;YYYYを固有アビ関数の「@固有アビ_25_YYYY」のYYYYと同じに変更する
;使用したアビリティの名前は「使用アビ名」に入ってくる
@KOJO_DUNGEON_固有アビ発動時_25_1(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;コラプス→ニュークリアシンサシス

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「ぷんぷん☆」
	DATA 「イタズラしちゃうぞぉ☆」
	DATA 「ご褒美、だよっ☆」
	DATA 「オシオキしちゃうぞ☆」
	DATA 「_I_遊んでやるよ_」
	DATA 「_I_一気に片付けてやる！_」
	DATA 「_I_嬉しいだろ？可愛い女の子に嬲られるなんてな！_」
	DATA 「_I_括目しな！これがカワイイって事だ！_」
ENDDATA

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

@KOJO_DUNGEON_固有アビ発動時_25_2(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;ファンタスマゴリア→アルケイナ・エボリューション

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「カリオストロ、わかっちゃった♪」
	DATA 「あなたのカッコイイとこ、もっと見たいなぁ_H_」
	DATA 「余所見はダメだぞっ_H_」
	DATA 「サポートならまかせて☆」
	DATA 「_I_好きなんだろぉ？ こういう女の子がさぁ〜_」
	DATA 「_I_お前、オレ様にときめいてんだろ？_」
	DATA 「_I_こんなもんは初歩の初歩だぜ_」
ENDDATA

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

@KOJO_DUNGEON_固有アビ発動時_25_3(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;リーンフォース→ネフシュタン

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「ごくろうさま☆」
	DATA 「まだ倒れちゃダ〜メ☆」
	DATA 「手取り足取り、治してあげる♪」
	DATA 「がんばれ_H_　がんばれ_H_」
	DATA 「ふぁいとっ☆　ふぁいとっ☆」
	DATA 「_I_世界一の美少女が癒してやるぜ_」
	DATA 「_I_まだやれるだろ？_」
	DATA 「_I_なんだかんだ、まだまだやれそうじゃねぇか_」
ENDDATA

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

@KOJO_DUNGEON_固有アビ発動時_25_11(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;アルス・グローリア

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

KSTR:(K++) = 「_I_錬金術の極致を見せてやるぜ！_」

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

@KOJO_DUNGEON_固有アビ発動時_25_12(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;エンデュミオン

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

KSTR:(K++) = 「カリオストロのために頑張って_H_」

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

@KOJO_DUNGEON_固有アビ発動時_25_13(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;ロード・トゥ・ジオメトリ

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

KSTR:(K++) = 「暴力反対☆」

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;奥義発動時
;--------------------------------------------------
@KOJO_DUNGEON_奥義発動時_25(対象キャラ, 使用奥義名)
#DIMS 使用奥義名
#DIM 対象キャラ
;「（キャラ名）の奥義：（奥義名）！」よりも前に表示される

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

IF 基礎BATTLE_STATE:LOCAL:Lv >= 35
	IF !RAND:4 && 陥落チェック(LOCAL)
		KSTR:(K++) = 「_I_あばよ！テメェはここで終身刑だ！！_」
	ELSEIF !RAND:3
		KSTR:(K++) = 「_I_これが錬金術の極致だ！_」
	ELSE
		KSTR:(K++) = 「_I_真理の前に跪け！_」
	ENDIF
ELSE
	KSTR:(K++) = 「これが真理のぉ…_I_一撃だ！_」
ENDIF

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ,,0,,対象キャラ)

;--------------------------------------------------
;チェンバースト発動時
;--------------------------------------------------
@KOJO_DUNGEON_チェンバ発動時_25(対象キャラ)
#DIM 対象キャラ
VARSET LOCAL
;「チェインバースト！」（フルチェイン！）よりも前に表示される
;該当キャラが起点になった時（＝ターンで最初に奥義を撃ったキャラ）しか呼ばれないので注意

CALL 口上変数初期化
VARSET LOCAL
LOCAL = キャラ隊列検索(対象キャラ)
LOCALS '= ""
LOCAL:2 = キャラ検索("[未完の錬金術師]クラリス")
LOCAL:3 = キャラ検索("[希求の錬金術師]ミレイユ")
LOCAL:4 = キャラ検索("[ミレイユの従者]リゼット")
LOCAL:12 = キャラ隊列検索(LOCAL:2) > -1 && FINDELEMENT(チェンバ基準キャラ保存, キャラ隊列検索(LOCAL:2))
LOCAL:13 = キャラ隊列検索(LOCAL:3) > -1 && FINDELEMENT(チェンバ基準キャラ保存, キャラ隊列検索(LOCAL:3))
LOCAL:14 = キャラ隊列検索(LOCAL:4) > -1 && FINDELEMENT(チェンバ基準キャラ保存, キャラ隊列検索(LOCAL:4))
IF LOCAL:12 || LOCAL:13 || LOCAL:14
	SIF LOCAL:12
		LOCALS += "クラリス、"
	SIF LOCAL:13
		LOCALS += "ミレイユ、"
	SIF LOCAL:14
		LOCALS += "リゼット、"
	KSTR:(K++) = 「_I_%LOCALS%息を合わせろ！ 一気に畳み掛けるぞ！！_」
	IF LOCAL:12
		NSTR:(K++) = ++++
		切り替え名前:(LOCAL:1) = %CALLNAME:(LOCAL:2)%
		切り替え顔グラリソース:(LOCAL:1) = 探索用_{キャラ隊列検索(LOCAL:2)}_顔
		KSTR:(K++) = 「う、うん！　わかったよししょー！！」
		LOCAL:1 ++
	ENDIF
	IF LOCAL:13
		NSTR:(K++) = ++++
		切り替え名前:(LOCAL:1) = %CALLNAME:(LOCAL:3)%
		切り替え顔グラリソース:(LOCAL:1) = 探索用_{キャラ隊列検索(LOCAL:3)}_顔
		KSTR:(K++) = 「わかったわ先生！」
		LOCAL:1 ++
	ENDIF
	IF LOCAL:14
		NSTR:(K++) = ++++
		切り替え名前:(LOCAL:1) = %CALLNAME:(LOCAL:4)%
		切り替え顔グラリソース:(LOCAL:1) = 探索用_{キャラ隊列検索(LOCAL:4)}_顔
		KSTR:(K++) = 「承知いたしました！」
		LOCAL:1 ++
	ENDIF
ELSE
	KSTR:(K++) = 「_I_余剰魔力が消散仕切る前に、纏め直して叩き込むぞ！！_」
ENDIF

;掛け合いの作り方
;ZZZZ = 掛け合い相手のCSVに記載してあるキャラ番号とする
;
; LOCAL:2 = GETCHARA(ZZZZ)
; IF キャラ隊列検索(LOCAL:2) > -1
; 	KSTR:(K++) = （口上キャラのセリフ）
;
; 	NSTR:(K++) = ++++
;	切り替え名前:0 = %CALLNAME:(LOCAL:2)%
; 	切り替え顔グラリソース:0 = 探索用_{キャラ隊列検索(LOCAL:2)}_顔
;
; 	KSTR:(K++) = （掛け合い相手のセリフ）
; ENDIF
;と記述すると下に一個、掛け合い相手の顔グラと名前が表示されたメッセージ欄を増やせるので、そこで掛け合いを行う
;複数個メッセージ欄を増やす場合、切り替え顔グラリソース:1、切り替え名前:1のように配列番号を１つずつ増やすこと

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;トドメ時
;--------------------------------------------------
@KOJO_DUNGEON_トドメ時_25(対象キャラ)
#DIM 対象キャラ

;行動の結果（◯◯は倒れた！など）の後に表示される
;複数攻撃時は一人でも倒していれば表示される

;口上用トドメフラグ には倒した敵の数が入っている
;口上用技名保存 には奥義名・アビ名が入っている
;       通常攻撃の場合は「通常攻撃」、チェンバの場合は「チェインバースト」が入っている

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「やったぁ☆」
	DATA 「ゴメンね？」
	DATA 「もう…お雑魚さん相手じゃ退屈しちゃう☆」
	DATA 「_I_けっ…雑魚じゃ相手にならねぇな！_」
	DATA 「_I_脇役はさっさと舞台を降りるんだな_」
	DATA 「_I_雑魚は引っ込んでろよ！_」
ENDDATA

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

; ;--------------------------------------------------
; ;味方から回復を受けた時
; ;「（キャラ名）のＨＰが」の直後に表示される
; ;複数人回復した場合、ランダムで一人の分が表示される
; ;--------------------------------------------------
; ;（現在未実装）
; @KOJO_DUNGEON_被回復時_25(対象キャラ)
; #DIM 対象キャラ
; CALL 口上変数初期化
; LOCAL = GETCHARA(25)
; LOCAL:1 = キャラ隊列検索(LOCAL)

; ;回復した側のキャラは「BATTLE_STATE:戦闘行動キャラ:キャラ登録番号」でキャラ番号が
; ;「戦闘行動キャラ」で隊列番号が取れる

; KSTR:(K++) = 

; CALL メッセージ欄表示用関数(@"探索用_{LOCAL:1}_顔", CALLNAME:LOCAL)

;--------------------------------------------------
;戦闘勝利時
;--------------------------------------------------
@KOJO_DUNGEON_戦闘勝利時_25(対象キャラ)
#DIM 対象キャラ

;ルピやEXPの取得よりも前に表示される

CALL メッセージ欄表示用関数(,,,0)
CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATAFORM 「カリオストロ頑張ったでしょ？ %CSTR:対象キャラ:二人称%さん、褒めて褒めて_H_」
	DATA 「やぁん、カリオストロ、勝っちゃったぁ_H_」
	DATA 「えへっ、カリオストロの勝ちぃ_H_」
	DATA 「ごめんね…カリオストロは無敵なの☆」
	DATA 「あれあれ～？ もうお終い？」
	DATA 「_I_口ほどにもなかったな_」
	DATA 「_I_はーっ 錬金術が冴え渡るぜ！_」
	DATA 「_I_オレ様に勝とうなんて、千年早ぇんだよ_」
	DATA 「_I_楽勝だったな！_」
	DATA 「_I_オレ様に挑んだ事、それがお前の敗因だ_」
ENDDATA

CALL カリオストロ本性開示()

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;全滅時
;--------------------------------------------------
@KOJO_DUNGEON_全滅時_25(対象キャラ)
#DIM 対象キャラ
CALL メッセージ欄表示用関数(,,,0)
CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)


STRDATA KSTR:(K++)
	DATA 「ふぇ～ん、カリオストロたち、負けちゃったぁ」
	DATA 「暴力はんた～い」
	DATA 「_I_嘘だろ、あり得ねぇ…_」
	DATA 「_I_オレ様としたことが……_」
	DATA 「_I_やってくれるじゃねぇか…_」
ENDDATA

CALL カリオストロ本性開示()

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;逃走時
;--------------------------------------------------
@KOJO_DUNGEON_逃走時_25(対象キャラ)
#DIM 対象キャラ
CALL メッセージ欄表示用関数(,,,0)
CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「ばいば～い☆」
	DATA 「これ以上相手してあげられないの、ゴメンね？」
	DATA 「_I_チッ、ここは一旦退くぞ！_」
	DATA 「_I_一時撤退だ、態勢を立て直すぞ！_」
	DATA 「_I_このまま相手するのは分が悪い、仕切り直すぞ_」
ENDDATA

CALL カリオストロ本性開示()

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)
