;レイヤーライズⅡ
@固有アビ_29_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

アビ名 = レイヤーライズⅡ
消費ＭＰ = 40


SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>対象に防御力［25％］ダウン効果［2ターン］
		詳細文文字列受け渡し変数 += @"<br>自身の攻撃力、防御力累積アップ効果［累積枠/10％/上限30％］"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		;攻防弱体部分
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_敵単体
		アビ汎用文字列:バフ・デバフ枠 = 攻撃力_累積
		アビ汎用文字列:バフ・デバフ枠 = 防御力_累積
		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
		アビ汎用文字列:バフ・デバフ対象能力 = 防御力
		アビ汎用変数:効果割合 = 10
		アビ汎用変数:累積上限_割合 = 30
		アビ汎用変数:持続ターン = 5
		CALL アビテンプレート_不利効果_累積デバフ効果セット
		
		;攻防強化部分
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 攻撃力_累積
		アビ汎用文字列:バフ・デバフ枠 = 防御力_累積
		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
		アビ汎用文字列:バフ・デバフ対象能力 = 防御力
		アビ汎用変数:効果割合 = 10
		アビ汎用変数:累積上限_割合 = 30
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_累積バフ効果セット
ENDSELECT

;イーヴィング･イグジスタンス　即発動なので重め
@固有アビ_29_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 40
	アビ名 = イーヴィング・イグジスタンス＋
	消費ＭＰ = 80
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 15
	アビ名 = イーヴィング・イグジスタンス
	消費ＭＰ = 50
ELSE
	アビ名 = 
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>味方全体に弱体無効効果［1回］
		IF アビ名 == "イーヴィング・イグジスタンス＋"
			詳細文文字列受け渡し変数 += @"<br>2Tの間、自身のTA率を100％上昇させる。行動消費無し。"
		ELSEIF アビ名 == "イーヴィング・イグジスタンス"
			詳細文文字列受け渡し変数 += @"<br>1Tの間、自身のTA率を100％上昇させる。行動消費無し。"
		ENDIF
		RETURN 消費ＭＰ
	CASE "アビ効果"
		;マウント部分
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_味方全体_生者のみ
		アビ汎用文字列:バフ・デバフ枠 = 弱体無効
		アビ汎用文字列:バフ・デバフ対象能力 = 弱体無効
		アビ汎用変数:持続回数 = 1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		;TA確定部分
		IF アビ名 == "イーヴィング･イグジスタンス＋"
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用変数:効果割合 = 100
			アビ汎用変数:持続ターン = 2
			アビ汎用変数:TA率補正値 = 100
			CALL アビテンプレート_有利効果_バフ効果セット
		ELSEIF アビ名 == "イーヴィング･イグジスタンス"
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用変数:効果割合 = 100
			アビ汎用変数:持続ターン = 1
			アビ汎用変数:TA率補正値 = 100
			CALL アビテンプレート_有利効果_バフ効果セット
		ENDIF
		アビテンプレート用_行動消費無しフラグ = 1
ENDSELECT
;アフェクション・オース　付加効果が強いので火力は控えめ。まぁ二回攻撃してるんで火力はあるんですけどね。
@固有アビ_29_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIM 効果数値
#DIMS アビ名
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 40
	アビ名 = アフェクション・オース＋
	効果数値 = 300
	消費ＭＰ = 200
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 30
	アビ名 = アフェクション・オース
	効果数値 = 200
	消費ＭＰ = 150
ELSE
	アビ名 = 
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵に［攻撃力×{効果数値}％］の闇属性と光属性ダメージを与え、自身のHPを[{効果数値}]回復する。
		詳細文文字列受け渡し変数 += @"<br>敵に光・闇属性攻撃低下［10］光・闇属性耐性低下［15］［5ターン］"
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		;攻撃部分
		CALL アビ対象選択テンプレート_敵単体
		;後半のデバフに向けて対象の保存
		LOCAL = アビテンプレート用_対象保存:0
		アビ汎用変数:効果割合 = 効果数値
		CALL アビテンプレート_ダメージ処理_光属性
		CALL アビテンプレート_ダメージ処理_闇属性
		
		;回復部分
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用変数:効果量 = 効果数値
		CALL アビテンプレート_回復処理_MAXでも回復
		
		;弱体・攻撃部分
		CALL アビ汎用変数文字列リセット
		;リセットしてから保存してた対象にデバフ掛けてく
		VARSET アビテンプレート用_対象保存, -1
		アビテンプレート用_対象保存:0 = LOCAL

		アビ汎用文字列:バフ・デバフ枠 = 光強化
		アビ汎用文字列:バフ・デバフ対象能力 = 光強化
		アビ汎用変数:効果割合 = 10
		アビ汎用変数:基礎成功確率 = 100
		アビ汎用変数:持続ターン = 5
		CALL アビテンプレート_不利効果_デバフ効果セット

		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 闇強化
		アビ汎用文字列:バフ・デバフ対象能力 = 闇強化
		アビ汎用変数:効果割合 = 10
		アビ汎用変数:基礎成功確率 = 100
		アビ汎用変数:持続ターン = 5
		CALL アビテンプレート_不利効果_デバフ効果セット

		;弱体・防御部分
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 光耐性
		アビ汎用文字列:バフ・デバフ対象能力 = 光耐性
		アビ汎用変数:効果割合 = 15
		アビ汎用変数:基礎成功確率 = 100
		アビ汎用変数:持続ターン = 5
		CALL アビテンプレート_不利効果_デバフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 闇耐性
		アビ汎用文字列:バフ・デバフ対象能力 = 闇耐性
		アビ汎用変数:効果割合 = 15
		アビ汎用変数:基礎成功確率 = 100
		アビ汎用変数:持続ターン = 5
		CALL アビテンプレート_不利効果_デバフ効果セット
ENDSELECT

