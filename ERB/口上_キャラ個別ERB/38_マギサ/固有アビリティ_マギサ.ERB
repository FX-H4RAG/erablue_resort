;固有アビリティ_マギサ
@固有アビ_38_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIM 効果数値
#DIM 効果成功率
#DIMS アビ名

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 28
	アビ名 = イラプション＋＋
	効果数値 = 260
	効果成功率 = 100
	消費ＭＰ = 80
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 16
	アビ名 = イラプション＋
	効果数値 = 230
	効果成功率 = 95
	消費ＭＰ = 60
ELSE
	アビ名 = イラプション
	効果数値 = 200
	効果成功率 = 90
	消費ＭＰ = 40
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵全体に自属性の［攻撃力✕{効果数値}％］ダメージを与える。
		詳細文文字列受け渡し変数 += @"<br>対象に３ターン火傷［最大HPの2％］効果を与える。基礎成功率{効果成功率}％。"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_敵全体_生者のみ

		アビ汎用変数:効果割合 = 効果数値
		CALL アビテンプレート_ダメージ処理_自属性
		
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果割合 = 2
		アビ汎用文字列:バフ・デバフ枠 = 火傷
		アビ汎用文字列:バフ・デバフ対象能力 = 火傷
		アビ汎用変数:持続ターン = 3
		アビ汎用変数:基礎成功確率 = 効果成功率
		CALL アビテンプレート_不利効果_デバフ効果セット
ENDSELECT
RETURN RESULT

@固有アビ_38_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 効果数値
#DIM 効果ターン

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 36
	アビ名 = ウォール＋＋
	消費ＭＰ = 60
	効果数値 = 30
	効果ターン = 3
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
	アビ名 = ウォール＋
	消費ＭＰ = 50
	効果数値 = 15
	効果ターン = 3
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 4
	アビ名 = ウォール
	消費ＭＰ = 40
ELSE
	アビ名 = 
ENDIF

アビ汎用文字列:実行時メッセージ１ = 魔力の防壁を展開した！

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>味方全体の状態異常および弱体化を一度だけ防ぐ魔法防壁を展開する。
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
			詳細文文字列受け渡し変数 += @"<br>パーティ全体に{効果ターン}ターン{効果数値}％攻撃力および防御力を上昇させる。"
		ENDIF
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_味方全体_生者のみ
		アビ汎用文字列:バフ・デバフ枠 = 弱体無効
		アビ汎用文字列:バフ・デバフ対象能力 = 弱体無効
		アビ汎用変数:持続回数 = 1
		CALL アビテンプレート_有利効果_バフ効果セット

		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
			CALL アビ汎用変数文字列リセット
			アビ汎用変数:効果割合 = 30
			アビ汎用文字列:バフ・デバフ枠 = 攻撃力A
			アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
			アビ汎用変数:持続ターン = 3
			CALL アビテンプレート_有利効果_バフ効果セット
			アビ汎用文字列:バフ・デバフ枠 = 防御力A
			アビ汎用文字列:バフ・デバフ対象能力 = 防御力
			CALL アビテンプレート_有利効果_バフ効果セット
		ENDIF
ENDSELECT
RETURN RESULT

@固有アビ_38_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIM 効果数値
#DIM 効果成功率
#DIMS アビ名

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 44
	アビ名 = ヴァルプルギス＋＋
	効果数値 = 400
	効果成功率 = 90
	消費ＭＰ = 120
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 32
	アビ名 = ヴァルプルギス＋
	効果数値 = 300
	効果成功率 = 85
	消費ＭＰ = 100
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 12
	アビ名 = ヴァルプルギス
	効果数値 = 200
	効果成功率 = 80
	消費ＭＰ = 80
ELSE
	アビ名 = 
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵全体に［攻撃力✕{効果数値}％］の闇属性ダメージを与える。
		詳細文文字列受け渡し変数 += @"<br>対象に暗闇効果を与える。基礎成功率{効果成功率}％"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_敵全体_生者のみ

		アビ汎用変数:効果割合 = 効果数値
		CALL アビテンプレート_ダメージ処理_闇属性

		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 暗闇
		アビ汎用文字列:バフ・デバフ対象能力 = 暗闇
		アビ汎用変数:持続ターン = 3
		アビ汎用変数:基礎成功確率 = 効果成功率
		アビ汎用変数:効果割合 = 50
		CALL アビテンプレート_不利効果_デバフ効果セット
ENDSELECT
RETURN RESULT

@固有アビ_38_4(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

IF イベント完了フラグ確認("魔女の（未定）") > 0
	アビ名 = サンクション
	消費ＭＰ = 120
ELSE
	アビ名 = 
ENDIF

SIF キャラ隊列検索(FINDCHARA(NO, 38)) > -1 && 戦闘中カウント:キャラ隊列検索(FINDCHARA(NO, 38)):1 > 0
    アビテンプレート用_アビ封印用フラグ = 1

アビ汎用文字列:実行時メッセージ１ = 召喚に応じ、魔神モラクスがその巨体を現す！

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>魔神モラクスを召喚する。
		詳細文文字列受け渡し変数 += @"<br>経過ターンごとに徐々に攻撃力が上昇。モラクスによる追撃付与。"
		詳細文文字列受け渡し変数 += @"<br>また、使用者はターンの最後にHPに100の自傷ダメージを受ける。"
		詳細文文字列受け渡し変数 += @"<br>上記の効果はリベレイションの使用以外では消去不可能。"
		詳細文文字列受け渡し変数 += @"<br>このアビリティは一回の戦闘で一度しか使えない。"
		RETURN 消費ＭＰ
	CASE "アビ効果"
	CALL アビ対象選択テンプレート_自己のみ
	戦闘中カウント:キャラ隊列検索(FINDCHARA(NO, 38)):2 = 現在ターン数
	アビ汎用変数:消去不可オプション = 1
	アビ汎用文字列:バフ・デバフ枠 = モラクス_攻撃
	アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
	アビ汎用変数:持続ターン = -1
	アビ汎用変数:効果割合 = 5
	アビ汎用変数:累積上限_固定値 = 99999
	CALL アビテンプレート_有利効果_累積バフ効果セット

	CALL アビ汎用変数文字列リセット
	
	アビ汎用変数:消去不可オプション = 1
	アビ汎用文字列:バフ・デバフ枠 = モラクス_追撃
	アビ汎用文字列:バフ・デバフ対象能力 = 追撃
	アビ汎用変数:持続ターン = -1
	アビ汎用変数:効果割合 = 100
	CALL アビテンプレート_有利効果_バフ効果セット

	CALL アビ汎用変数文字列リセット
	
	アビ汎用変数:消去不可オプション = 1
	アビ汎用文字列:バフ・デバフ枠 = モラクス_自傷
	アビ汎用文字列:バフ・デバフ対象能力 = 自傷
	アビ汎用変数:持続ターン = -1
	アビ汎用変数:効果量 = 100
	CALL アビテンプレート_不利効果_デバフ効果セット
	
	戦闘中カウント:キャラ隊列検索(FINDCHARA(NO, 38)):1 = 0
	
ENDSELECT
RETURN RESULT

@固有ターン終了時処理_キャラ_38
;ターン終了時処理関数から呼び出し
#DIM バフ・デバフ行数
#DIM 隊列番号

隊列番号 = キャラ隊列検索(FINDCHARA(NO, 38))

バフ・デバフ行数 = バフ存在チェック_枠("モラクス_攻撃", 隊列番号)
IF バフ・デバフ行数 > -1
	WSTR:(K++) = 魔神モラクスが力を増していく……！
	
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:消去不可オプション = 1
	アビ汎用文字列:バフ・デバフ枠 = モラクス_攻撃
	アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
	アビ汎用変数:持続ターン = -1
	アビ汎用変数:効果割合 = 5
	アビ汎用変数:累積上限_固定値 = 99999
	CALL アビテンプレート_有利効果_累積バフ効果セット
ENDIF

@固有アビ_38_5(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

IF イベント完了フラグ確認("魔女の（未定）") > 0
	アビ名 = リベレイション
	消費ＭＰ = 120
ELSE
	アビ名 = 
ENDIF

SIF キャラ隊列検索(FINDCHARA(NO, 38)) > -1 && 戦闘中カウント:キャラ隊列検索(FINDCHARA(NO, 38)):1 != 1
    アビテンプレート用_アビ封印用フラグ = 1

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
		アビ汎用文字列:実行時メッセージ１ = 蓄積された魔力が一気に解放される……！
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>召喚中の魔神モラクスの力を解放する。
		詳細文文字列受け渡し変数 += @"<br>サンクションによる魔神モラクスの効果を全て消去し、"
		詳細文文字列受け渡し変数 += @"<br>敵全体に［攻撃力×累積ターン数×40％］の自属性ダメージを与える。"
		詳細文文字列受け渡し変数 += @"<br>このアビリティはサンクション使用後のみ、一度だけ使うことが可能になる。"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_敵全体_生者のみ
		CALL アビテンプレート_ダメージ処理_自属性
		アビ汎用変数:効果割合 = 40 * (現在ターン数 - 戦闘中カウント:キャラ隊列検索(FINDCHARA(NO, 38)):2)		
		
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用変数:消去不可バフデバフ削除オプション = 1
		CALL アビテンプレート_不利効果_バフ消去("モラクス_追撃")
		CALL アビテンプレート_不利効果_バフ消去("モラクス_攻撃")
		CALL アビテンプレート_有利効果_デバフ消去("モラクス_自傷")
		
		戦闘中カウント:キャラ隊列検索(FINDCHARA(NO, 38)):1 += 1
ENDSELECT
RETURN RESULT
