
@固有アビ_8_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM シンダラ隊列
#DIM 双虎乱舞
#DIM 虎帯
#DIM 攻撃対象

シンダラ隊列 = キャラ隊列検索(GETCHARA(8))
双虎乱舞 = バフ番号取得_枠("双虎乱舞", シンダラ隊列)

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
	アビ名 = 悪運散虎+
	IF バフ番号取得_枠("双虎乱舞", シンダラ隊列) > -1
		消費ＭＰ = 0
	ELSE
		消費ＭＰ = 100
	ENDIF
ELSE
	アビ名 = 悪運散虎
	IF バフ番号取得_枠("双虎乱舞", シンダラ隊列) > -1
		消費ＭＰ = 0
	ELSE
		消費ＭＰ = 100
	ENDIF
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に土属性［攻撃力×200％］ダメージ
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
			詳細文文字列受け渡し変数 += @"<br>対象に攻撃力［10％］累積ダウン効果［累積枠/最大40％/5ターン］"
			詳細文文字列受け渡し変数 += @"<br>対象に防御力［10％］累積ダウン効果［累積枠/最大40％/5ターン］"
		ELSE
			詳細文文字列受け渡し変数 += @"<br>対象に攻撃力［10％］累積ダウン効果［累積枠/最大30％/5ターン］"
			詳細文文字列受け渡し変数 += @"<br>対象に防御力［10％］累積ダウン効果［累積枠/最大30％/5ターン］"
		ENDIF
		詳細文文字列受け渡し変数 += @"<br>◆対象の虎帯Lvに応じて、対象に弱体効果を付与"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_敵単体
		アビ汎用変数:効果割合 = 200
		CALL アビテンプレート_ダメージ処理_土属性
		
		攻撃対象 = アビテンプレート用_対象保存:0
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 攻撃力_累積枠
		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
		アビ汎用変数:効果割合 = 10
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
			アビ汎用変数:累積上限_割合 = 40
		ELSE
			アビ汎用変数:累積上限_割合 = 30
		ENDIF
		アビ汎用変数:持続ターン = 5
		CALL アビテンプレート_不利効果_累積デバフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 防御力_累積枠
		アビ汎用文字列:バフ・デバフ対象能力 = 防御力
		アビ汎用変数:効果割合 = 10
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
			アビ汎用変数:累積上限_割合 = 40
		ELSE
			アビ汎用変数:累積上限_割合 = 30
		ENDIF
		アビ汎用変数:持続ターン = 5
		CALL アビテンプレート_不利効果_累積デバフ効果セット
		
		虎帯 = DT_CELL_GET(@"デバフデータベース_{攻撃対象}", デバフ番号取得_枠("虎帯", 攻撃対象), "デバフ効果量_固定値")
		IF 虎帯 > 0
			IF 虎帯 < 5 
				FOR LOCAL, 0, 虎帯
					$REDRAW1
					SELECTCASE RAND:5
						CASE 0
							IF 戦闘中カウント:戦闘行動キャラ:0 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:0 = 1
						CASE 1 
							IF 戦闘中カウント:戦闘行動キャラ:1 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:1 = 1
						CASE 2
							IF 戦闘中カウント:戦闘行動キャラ:2 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:2 = 1
						CASE 3
							IF 戦闘中カウント:戦闘行動キャラ:3 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:3 = 1
						CASE 4
							IF 戦闘中カウント:戦闘行動キャラ:4 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:4 = 1
					ENDSELECT
				NEXT
			ELSEIF 虎帯 == 5
				戦闘中カウント:戦闘行動キャラ:0 = 1
				戦闘中カウント:戦闘行動キャラ:1 = 1
				戦闘中カウント:戦闘行動キャラ:2 = 1
				戦闘中カウント:戦闘行動キャラ:3 = 1
				戦闘中カウント:戦闘行動キャラ:4 = 1 
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:0 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = 水強化
				アビ汎用文字列:バフ・デバフ対象能力 = 水強化
				アビ汎用変数:効果割合 = 20
				アビ汎用変数:持続ターン = 5
				CALL アビテンプレート_不利効果_デバフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:1 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = 土耐性
				アビ汎用文字列:バフ・デバフ対象能力 = 土耐性
				アビ汎用変数:効果割合 = 20
				アビ汎用変数:持続ターン = 5
				CALL アビテンプレート_不利効果_デバフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:2 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = 弱体耐性_アビ枠
				アビ汎用文字列:バフ・デバフ対象能力 = 弱体耐性
				アビ汎用変数:効果割合 = 20
				アビ汎用変数:持続ターン = 5
				CALL アビテンプレート_不利効果_デバフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:3 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = 暗闇_個人枠
				アビ汎用文字列:バフ・デバフ対象能力 = 暗闇
				アビ汎用変数:効果割合 = 50
				アビ汎用変数:持続ターン = 3
				CALL アビテンプレート_不利効果_デバフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:4 == 1
				CALL アビ汎用変数文字列リセット
				CALL アビテンプレート_不利効果_バフ消去
			ENDIF
			
			戦闘中カウント:戦闘行動キャラ:0 = 0
			戦闘中カウント:戦闘行動キャラ:1 = 0
			戦闘中カウント:戦闘行動キャラ:2 = 0
			戦闘中カウント:戦闘行動キャラ:3 = 0
			戦闘中カウント:戦闘行動キャラ:4 = 0
		ENDIF
		
		IF バフ番号取得_枠("双虎乱舞", シンダラ隊列) > -1
			
			CALL アビ汎用変数文字列リセット
			アビ汎用変数:効果割合 = 200
			CALL アビテンプレート_ダメージ処理_土属性
			
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用文字列:バフ・デバフ枠 = 攻撃力_別枠累積A枠
			アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
			アビ汎用変数:効果割合 = 10
			IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
				アビ汎用変数:累積上限_割合 = 40
			ELSE
				アビ汎用変数:累積上限_割合 = 30
			ENDIF
			アビ汎用変数:持続ターン = -1
			CALL アビテンプレート_有利効果_累積バフ効果セット
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 防御力_累積A枠
			アビ汎用文字列:バフ・デバフ対象能力 = 防御力
			アビ汎用変数:効果割合 = 10
			IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
				アビ汎用変数:累積上限_割合 = 40
			ELSE
				アビ汎用変数:累積上限_割合 = 30
			ENDIF
			アビ汎用変数:持続ターン = -1
			CALL アビテンプレート_有利効果_累積バフ効果セット
			
			虎帯 = DT_CELL_GET(@"デバフデータベース_{攻撃対象}", デバフ番号取得_枠("虎帯", 攻撃対象), "デバフ効果量_固定値")
			IF 虎帯 > 0
				IF 虎帯 < 5 
					FOR LOCAL, 0, 虎帯
						$REDRAW2
						SELECTCASE RAND:5
							CASE 0
								IF 戦闘中カウント:戦闘行動キャラ:0 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:0 = 1
							CASE 1 
								IF 戦闘中カウント:戦闘行動キャラ:1 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:1 = 1
							CASE 2
								IF 戦闘中カウント:戦闘行動キャラ:2 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:2 = 1
							CASE 3
								IF 戦闘中カウント:戦闘行動キャラ:3 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:3 = 1
							CASE 4
								IF 戦闘中カウント:戦闘行動キャラ:4 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:4 = 1
						ENDSELECT
					NEXT
				ELSEIF 虎帯 == 5
					戦闘中カウント:戦闘行動キャラ:0 = 1
					戦闘中カウント:戦闘行動キャラ:1 = 1
					戦闘中カウント:戦闘行動キャラ:2 = 1
					戦闘中カウント:戦闘行動キャラ:3 = 1
					戦闘中カウント:戦闘行動キャラ:4 = 1 
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:0 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用変数:効果量 = 15
					CALL アビテンプレート_有利効果_奥義ゲージUP
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:1 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用文字列:バフ・デバフ枠 = ディスペルガード
					アビ汎用文字列:バフ・デバフ対象能力 = ディスペルガード
					アビ汎用変数:持続回数 = 1
					CALL アビテンプレート_有利効果_バフ効果セット
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:2 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用文字列:バフ・デバフ枠 = 幻影
					アビ汎用文字列:バフ・デバフ対象能力 = 幻影
					アビ汎用変数:持続回数 = 1
					CALL アビテンプレート_有利効果_バフ効果セット
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:3 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用文字列:バフ・デバフ枠 = バリア
					アビ汎用文字列:バフ・デバフ対象能力 = バリア
					アビ汎用変数:効果量 = 300
					アビ汎用変数:持続ターン = -1
					CALL アビテンプレート_不利効果_デバフ効果セット
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:4 == 1
					アビ汎用文字列:バフ・デバフ枠 = 奥義再発動
					アビ汎用文字列:バフ・デバフ対象能力 = 奥義再発動
					アビ汎用変数:持続回数 = 1
					CALL アビテンプレート_有利効果_バフ効果セット
				ENDIF
				
				戦闘中カウント:戦闘行動キャラ:0 = 0
				戦闘中カウント:戦闘行動キャラ:1 = 0
				戦闘中カウント:戦闘行動キャラ:2 = 0
				戦闘中カウント:戦闘行動キャラ:3 = 0
				戦闘中カウント:戦闘行動キャラ:4 = 0
			ENDIF
				
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用変数:消去不可バフデバフ削除オプション = 1
			CALL アビテンプレート_不利効果_バフ消去("双虎乱舞")
			
			アビテンプレート用_行動消費無しフラグ = 1
		ENDIF
ENDSELECT



@固有アビ_8_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM シンダラ隊列
#DIM 双虎乱舞
#DIM 虎帯
#DIM 攻撃対象

シンダラ隊列 = キャラ隊列検索(GETCHARA(9))
;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 65
	アビ名 = 良運散虎+
	IF バフ番号取得_枠("双虎乱舞", シンダラ隊列) > -1
		消費ＭＰ = 0
	ELSE
		消費ＭＰ = 100
	ENDIF
ELSE
	アビ名 = 良運散虎
	IF バフ番号取得_枠("双虎乱舞", シンダラ隊列) > -1
		消費ＭＰ = 0
	ELSE
		消費ＭＰ = 100
	ENDIF
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に土属性［攻撃力×200％］ダメージ
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
			詳細文文字列受け渡し変数 += @"<br>自身に攻撃力［10％］累積ダウン効果［別枠累積A枠/最大40％/5ターン］"
			詳細文文字列受け渡し変数 += @"<br>自身に防御力［10％］累積ダウン効果［累積A枠/最大40％/5ターン］"
		ELSE
			詳細文文字列受け渡し変数 += @"<br>自身に攻撃力［10％］累積ダウン効果［別枠累積A枠/最大30％/5ターン］"
			詳細文文字列受け渡し変数 += @"<br>自身に防御力［10％］累積ダウン効果［累積A枠/最大30％/5ターン］"
		ENDIF
		詳細文文字列受け渡し変数 += @"<br>◆対象の虎帯Lvに応じて、自身に強化効果を付与"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_敵単体
		アビ汎用変数:効果割合 = 200
		CALL アビテンプレート_ダメージ処理_土属性
		
		攻撃対象 = アビテンプレート用_対象保存:0
		
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 攻撃力_別枠累積A枠
		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
		アビ汎用変数:効果割合 = 10
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
			アビ汎用変数:累積上限_割合 = 40
		ELSE
			アビ汎用変数:累積上限_割合 = 30
		ENDIF
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_累積バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 防御力_累積A枠
		アビ汎用文字列:バフ・デバフ対象能力 = 防御力
		アビ汎用変数:効果割合 = 10
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
			アビ汎用変数:累積上限_割合 = 40
		ELSE
			アビ汎用変数:累積上限_割合 = 30
		ENDIF
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_累積バフ効果セット
		
		虎帯 = DT_CELL_GET(@"デバフデータベース_{攻撃対象}", デバフ番号取得_枠("虎帯", 攻撃対象), "デバフ効果量_固定値")
		IF 虎帯 > 0
			IF 虎帯 < 5 
				FOR LOCAL, 0, 虎帯
					$REDRAW1
					SELECTCASE RAND:5
						CASE 0
							IF 戦闘中カウント:戦闘行動キャラ:0 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:0 = 1
						CASE 1 
							IF 戦闘中カウント:戦闘行動キャラ:1 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:1 = 1
						CASE 2
							IF 戦闘中カウント:戦闘行動キャラ:2 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:2 = 1
						CASE 3
							IF 戦闘中カウント:戦闘行動キャラ:3 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:3 = 1
						CASE 4
							IF 戦闘中カウント:戦闘行動キャラ:4 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:4 = 1
					ENDSELECT
				NEXT
			ELSEIF 虎帯 == 5
				戦闘中カウント:戦闘行動キャラ:0 = 1
				戦闘中カウント:戦闘行動キャラ:1 = 1
				戦闘中カウント:戦闘行動キャラ:2 = 1
				戦闘中カウント:戦闘行動キャラ:3 = 1
				戦闘中カウント:戦闘行動キャラ:4 = 1 
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:0 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用変数:効果量 = 15
				CALL アビテンプレート_有利効果_奥義ゲージUP
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:1 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = ディスペルガード
				アビ汎用文字列:バフ・デバフ対象能力 = ディスペルガード
				アビ汎用変数:持続回数 = 1
				CALL アビテンプレート_有利効果_バフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:2 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = 幻影
				アビ汎用文字列:バフ・デバフ対象能力 = 幻影
				アビ汎用変数:持続回数 = 1
				CALL アビテンプレート_有利効果_バフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:3 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = バリア
				アビ汎用文字列:バフ・デバフ対象能力 = バリア
				アビ汎用変数:効果量 = 300
				アビ汎用変数:持続ターン = -1
				CALL アビテンプレート_不利効果_デバフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:4 == 1
				アビ汎用文字列:バフ・デバフ枠 = 奥義再発動
				アビ汎用文字列:バフ・デバフ対象能力 = 奥義再発動
				アビ汎用変数:持続回数 = 1
				CALL アビテンプレート_有利効果_バフ効果セット
			ENDIF
			
			戦闘中カウント:戦闘行動キャラ:0 = 0
			戦闘中カウント:戦闘行動キャラ:1 = 0
			戦闘中カウント:戦闘行動キャラ:2 = 0
			戦闘中カウント:戦闘行動キャラ:3 = 0
			戦闘中カウント:戦闘行動キャラ:4 = 0
		ENDIF
		
		IF バフ番号取得_枠("双虎乱舞", シンダラ隊列) > -1
			
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_指定(攻撃対象)
			アビ汎用変数:効果割合 = 200
			CALL アビテンプレート_ダメージ処理_土属性
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 攻撃力_累積枠
			アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
			アビ汎用変数:効果割合 = 10
			IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
				アビ汎用変数:累積上限_割合 = 40
			ELSE
				アビ汎用変数:累積上限_割合 = 30
			ENDIF
			アビ汎用変数:持続ターン = 5
			CALL アビテンプレート_不利効果_累積デバフ効果セット
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 防御力_累積枠
			アビ汎用文字列:バフ・デバフ対象能力 = 防御力
			アビ汎用変数:効果割合 = 10
			IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
				アビ汎用変数:累積上限_割合 = 40
			ELSE
				アビ汎用変数:累積上限_割合 = 30
			ENDIF
			アビ汎用変数:持続ターン = 5
			CALL アビテンプレート_不利効果_累積デバフ効果セット
			
			攻撃対象 = アビテンプレート用_対象保存:0
			
			虎帯 = DT_CELL_GET(@"デバフデータベース_{攻撃対象}", デバフ番号取得_枠("虎帯", 攻撃対象), "デバフ効果量_固定値")
			IF 虎帯 > 0
				IF 虎帯 < 5 
					FOR LOCAL, 0, 虎帯
						$REDRAW2
						SELECTCASE RAND:5
							CASE 0
								IF 戦闘中カウント:戦闘行動キャラ:0 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:0 = 1
							CASE 1 
								IF 戦闘中カウント:戦闘行動キャラ:1 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:1 = 1
							CASE 2
								IF 戦闘中カウント:戦闘行動キャラ:2 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:2 = 1
							CASE 3
								IF 戦闘中カウント:戦闘行動キャラ:3 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:3 = 1
							CASE 4
								IF 戦闘中カウント:戦闘行動キャラ:4 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:4 = 1
						ENDSELECT
					NEXT
				ELSEIF 虎帯 == 5
					戦闘中カウント:戦闘行動キャラ:0 = 1
					戦闘中カウント:戦闘行動キャラ:1 = 1
					戦闘中カウント:戦闘行動キャラ:2 = 1
					戦闘中カウント:戦闘行動キャラ:3 = 1
					戦闘中カウント:戦闘行動キャラ:4 = 1 
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:0 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用文字列:バフ・デバフ枠 = 水強化
					アビ汎用文字列:バフ・デバフ対象能力 = 水強化
					アビ汎用変数:効果割合 = 20
					アビ汎用変数:持続ターン = 5
					CALL アビテンプレート_不利効果_デバフ効果セット
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:1 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用文字列:バフ・デバフ枠 = 土耐性
					アビ汎用文字列:バフ・デバフ対象能力 = 土耐性
					アビ汎用変数:効果割合 = 20
					アビ汎用変数:持続ターン = 5
					CALL アビテンプレート_不利効果_デバフ効果セット
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:2 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用文字列:バフ・デバフ枠 = 弱体耐性_アビ枠
					アビ汎用文字列:バフ・デバフ対象能力 = 弱体耐性
					アビ汎用変数:効果割合 = 20
					アビ汎用変数:持続ターン = 5
					CALL アビテンプレート_不利効果_デバフ効果セット
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:3 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用文字列:バフ・デバフ枠 = 暗闇_個人枠
					アビ汎用文字列:バフ・デバフ対象能力 = 暗闇
					アビ汎用変数:効果割合 = 50
					アビ汎用変数:持続ターン = 3
					CALL アビテンプレート_不利効果_デバフ効果セット
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:4 == 1
					CALL アビ汎用変数文字列リセット
					CALL アビテンプレート_不利効果_バフ消去
				ENDIF
				
				戦闘中カウント:戦闘行動キャラ:0 = 0
				戦闘中カウント:戦闘行動キャラ:1 = 0
				戦闘中カウント:戦闘行動キャラ:2 = 0
				戦闘中カウント:戦闘行動キャラ:3 = 0
				戦闘中カウント:戦闘行動キャラ:4 = 0
			ENDIF
			
				
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用変数:消去不可バフデバフ削除オプション = 1
			CALL アビテンプレート_不利効果_バフ消去("双虎乱舞")

			アビテンプレート用_行動消費無しフラグ = 1
		ENDIF
ENDSELECT



@固有アビ_8_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 対象番号

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 45
	アビ名 = 双虎風水
	消費ＭＰ = 500
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>自身に双虎風水効果［1ターン/消去不可］
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 双虎風水
		アビ汎用文字列:バフ・デバフ対象能力 = 双虎風水
		アビ汎用変数:持続ターン = 1
		アビ汎用変数:消去不可オプション = 1
		アビ汎用変数:特殊表示オプション = 1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		DT_ROW_ADD @"バフデータベース_{戦闘行動キャラ}", "バフ枠", "双虎風水_完全回避", "バフ対象能力", "被ダメージ", "バフ効果量_割合", 100, "バフ名", "双虎風水", "持続ターン", 1, "消去不可フラグ", 1
		DT_ROW_ADD @"バフデータベース_{戦闘行動キャラ}", "バフ枠", "双虎風水_全体かばう", "バフ対象能力", "全体かばう", "バフ名", "双虎風水", "持続ターン", 1, "消去不可フラグ", 1
ENDSELECT



@固有戦闘開始時処理_キャラ_8
#DIM シンダラ隊列

シンダラ隊列 = キャラ隊列検索(GETCHARA(8))

DT_ROW_ADD @"バフデータベース_{シンダラ隊列}", "バフ枠", "寅神宮の主", "バフ対象能力", "寅神宮の主", "バフ名", "寅神宮の主", "持続ターン", -1, "消去不可フラグ", 1, "特殊表示オプション", 1
DT_ROW_ADD @"バフデータベース_{シンダラ隊列}", "バフ枠", "寅神宮の主_敵対心", "バフ対象能力", "敵対心", "バフ効果量_固定値", 100, "バフ名", "寅神宮の主", "持続ターン", -1, "消去不可フラグ", 1
DT_ROW_ADD @"デバフデータベース_{シンダラ隊列}", "デバフ枠", "寅神宮の主_弱体耐性", "デバフ対象能力", "弱体耐性", "デバフ効果量_割合", 20, "持続ターン", -1, "消去不可フラグ", 1
DT_ROW_ADD @"バフデータベース_{シンダラ隊列}", "バフ枠", "寅神宮の主_攻撃力", "バフ対象能力", "攻撃力", "バフ効果量_割合", 30, "バフ名", "寅神宮の主", "持続ターン", -1, "消去不可フラグ", 1
DT_ROW_ADD @"バフデータベース_{シンダラ隊列}", "バフ枠", "寅神宮の主_絶対DA", "バフ対象能力", "DA率", "バフ効果量_固定値", 1000, "バフ名", "寅神宮の主", "持続ターン", -1, "消去不可フラグ", 1



@固有行動開始時処理_キャラ_8
#DIM シンダラ隊列

シンダラ隊列 = キャラ隊列検索(GETCHARA(8))

IF 行動不能フラグ == 1
	WSTR:(K++) = シンダラの災転福為！
	
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:効果量 = 222
	CALL アビテンプレート_回復処理_MAXでも回復
	
	IF DT_ROW_LENGTH(@"デバフデータベース_{シンダラ隊列}") > 0
		FOR LOCAL, 0, DT_ROW_LENGTH(@"デバフデータベース_{シンダラ隊列}")
			CALL アビテンプレート_有利効果_デバフ消去()
		NEXT
	ENDIF
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 再行動
	アビ汎用文字列:バフ・デバフ対象能力 = 再行動
	アビ汎用変数:効果量 = 1
	アビ汎用変数:持続ターン = 2
	アビ汎用変数:消去不可オプション = 1
	CALL アビテンプレート_有利効果_バフ効果セット
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 追撃_アビB枠
	アビ汎用文字列:バフ・デバフ対象能力 = 追撃
	アビ汎用変数:効果割合 = 40
	アビ汎用変数:持続ターン = 2
	アビ汎用変数:消去不可オプション = 1
	CALL アビテンプレート_有利効果_バフ効果セット
ENDIF



@固有通常攻撃後処理_キャラ_8(全滅フラグ, 連撃数)
#DIM 連撃数
#DIM 全滅フラグ
#DIM 攻撃対象
#DIM 虎帯攻撃
#DIM 虎帯防御
#DIM 効果倍率

SIF 全滅フラグ
	RETURN 0

IF 連撃数 == 3
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 虎帯
	アビ汎用文字列:バフ・デバフ対象能力 = 虎帯
	アビ汎用変数:効果量 = 1
	アビ汎用変数:累積上限_固定値 = 5
	アビ汎用変数:持続ターン = -1
	アビ汎用変数:消去不可オプション = 1
	アビ汎用変数:特殊表示オプション = 1
	CALL アビテンプレート_不利効果_累積デバフ効果セット
	
	攻撃対象 = アビテンプレート用_対象保存:0
	虎帯攻撃 = デバフ番号取得_枠("虎帯_攻撃力", 攻撃対象)
	虎帯防御 = デバフ番号取得_枠("虎帯_防御力", 攻撃対象)
	効果倍率 = DT_CELL_GET(@"デバフデータベース_{攻撃対象}", デバフ番号取得_枠("虎帯", 攻撃対象), "デバフ効果量_固定値")
	
	IF 効果倍率 > 0
		DT_CELL_SET @"デバフデータベース_{攻撃対象}", 虎帯攻撃, "デバフ効果量_割合", 3 * 効果倍率
		DT_CELL_SET @"デバフデータベース_{攻撃対象}", 虎帯防御, "デバフ効果量_割合", 3 * 効果倍率
	ELSEIF 効果倍率 == 0
		DT_ROW_ADD @"デバフデータベース_{攻撃対象}", "デバフ枠", "虎帯_攻撃力", "デバフ対象能力", "攻撃力", "デバフ効果量_割合", 3, "持続ターン", -1, "消去不可フラグ", 1
		DT_ROW_ADD @"デバフデータベース_{攻撃対象}", "デバフ枠", "虎帯_防御力", "デバフ対象能力", "防御力", "デバフ効果量_割合", 3, "持続ターン", -1, "消去不可フラグ", 1
	ENDIF
ENDIF



@固有ターン終了時処理_キャラ_8
#DIM シンダラ隊列

シンダラ隊列 = キャラ隊列検索(GETCHARA(8))

IF バフ番号取得_枠("双虎風水", シンダラ隊列) > -1
	WSTR:(K++) = シンダラの双虎風水！
	
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用文字列:バフ・デバフ枠 = 与ダメ増加_固有枠
	アビ汎用文字列:バフ・デバフ対象能力 = 与ダメージ
	アビ汎用変数:効果割合 = 25
	アビ汎用変数:持続ターン = 2
	アビ汎用変数:消去不可オプション = 1
	CALL アビテンプレート_有利効果_バフ効果セット
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 絶対TA_単体枠
	アビ汎用文字列:バフ・デバフ対象能力 = TA率
	アビ汎用変数:効果量 = 1000
	アビ汎用変数:持続ターン = 2
	アビ汎用変数:消去不可オプション = 1
	CALL アビテンプレート_有利効果_バフ効果セット
ENDIF

IF バフ番号取得_枠("双虎風水", シンダラ隊列) > -1
	WSTR:(K++) = シンダラの災転福為！
	
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:効果量 = 222
	CALL アビテンプレート_回復処理_MAXでも回復
	
	IF DT_ROW_LENGTH(@"デバフデータベース_{シンダラ隊列}") > 0
		FOR LOCAL, 0, DT_ROW_LENGTH(@"デバフデータベース_{シンダラ隊列}")
			CALL アビテンプレート_有利効果_デバフ消去()
		NEXT
	ENDIF
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 再行動
	アビ汎用文字列:バフ・デバフ対象能力 = 再行動
	アビ汎用変数:効果量 = 1
	アビ汎用変数:持続ターン = 2
	アビ汎用変数:消去不可オプション = 1
	CALL アビテンプレート_有利効果_バフ効果セット
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 追撃_アビB枠
	アビ汎用文字列:バフ・デバフ対象能力 = 追撃
	アビ汎用変数:効果割合 = 40
	アビ汎用変数:持続ターン = 2
	アビ汎用変数:消去不可オプション = 1
	CALL アビテンプレート_有利効果_バフ効果セット
ENDIF



@バフ・デバフ特殊表示_寅神宮の主(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 寅神宮の主
PRINTFORML 敵のターゲットにされやすく弱体耐性が低いが、攻撃力が上昇/必ず連続攻撃/トリプルアタック時、敵に虎帯効果を与える状態［消去不可］
PRINTFORML 持続ターン：永続



@バフ・デバフ特殊表示_双虎乱舞(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 双虎乱舞
PRINTFORML 次の悪運散虎・良運招虎が両方発動し、MP・行動回数を消費しない状態［消去不可］
PRINTFORML 持続回数：1



@バフ・デバフ特殊表示_双虎風水(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 双虎風水
PRINTFORML 全ての攻撃を回避/攻撃を味方の代わりに受ける/攻撃行動を行わないが、次のターンに与えるダメージが上昇し必ずトリプルアタックを行う状態［消去不可］
PRINTFORML 持続ターン：1



@バフ・デバフ特殊表示_虎帯(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 虎帯
PRINTFORML Lvに応じて攻撃力・防御力が減少/シンダラの悪運散虎・良運招虎に追加効果が発生する状態［回復不可］
PRINTFORML Lv：{DT_CELL_GET(@"デバフデータベース_{隊列番号}", バフ・デバフ行数, "デバフ効果量_固定値")}　　　　　持続ターン：永続

