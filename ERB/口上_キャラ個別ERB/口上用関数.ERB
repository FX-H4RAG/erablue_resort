@口上変数初期化
VARSET KSTR
VARSET WSTR
VARSET NSTR
VARSET WNSTR
K = 0
VARSET K_CALL
VARSET KCOLOR,-1
TSTR:メッセージ欄文字列受け渡し_下側 = 

;KSTR:(K++) = 
;WSTR:(K++) = 
;NSTR:(K++) = 

;K_CALL:K = 
;KCOLOR:K = 


@口上変数表示,ARG = -1,ARG:1 = 0
SIF !口上有無確認(0,1)
	RETURN 0
SIF ARG == -1
	ARG = TARGET
FOR LOCAL,0,1000
	IF !(K_CALL:LOCAL == "")
		CALLFORM %K_CALL:LOCAL%
		SIF LOCAL > 0
			CALL WSTR書き込み,LOCAL - 1
	ENDIF
	SIF !口上有無確認(LOCAL,1)
		BREAK
	SIF KCOLOR:LOCAL > -1
		SETCOLOR KCOLOR:LOCAL
	IF !(WSTR:LOCAL == "")
		CALL PRINT_STRW(WSTR:LOCAL,ARG)
	ELSEIF !(KSTR:LOCAL == "")
		CALL PRINT_STRL(KSTR:LOCAL,ARG)
	ELSEIF !(NSTR:LOCAL == "")
		CALL PRINT_STR(NSTR:LOCAL,ARG)
	ENDIF
NEXT
RESETCOLOR
SIF WSTR:(LOCAL - 2) == "" && ARG:1 == 0
	WAIT
RETURN 1

@WSTR書き込み,ARG
IF !(WSTR:ARG == "")
ELSEIF !(KSTR:ARG == "")
	WSTR:ARG = %KSTR:ARG%
ELSEIF !(NSTR:ARG == "")
	WSTR:ARG = %NSTR:ARG%
ENDIF

@口上有無確認,ARG,ARG:1 = 0
#FUNCTION
;ARG:1　0だとKを口上のない番号に移動
IF ARG:1 == 0
	FOR LOCAL,0,1000
		SIF !(WSTR:LOCAL == "")
			CONTINUE
		SIF !(KSTR:LOCAL == "")
			CONTINUE
		SIF !(NSTR:LOCAL == "")
			CONTINUE
		K = LOCAL
		BREAK
	NEXT
ENDIF
SIF !(WSTR:ARG == "")
	RETURNF 1
SIF !(KSTR:ARG == "")
	RETURNF 1
SIF !(NSTR:ARG == "")
	RETURNF 1
RETURNF 0





