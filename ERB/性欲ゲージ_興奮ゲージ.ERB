

;-------------------------------------------------------------------------------------------
;性欲ゲージ関連処理
;上昇量を素質で補正すること
;-------------------------------------------------------------------------------------------

@性欲ゲージ増加(ARG)
;性欲無しだと何もしない
SIF TALENT:ARG:性欲 == -2
	RETURN 0

;基礎値=時間経過分/4の性欲（一日360）ABL欲望１につき10%の補正
LOCAL = (10 + ABL:ARG:欲望) * TIME_PROGRESS(TFLAG:行動前時刻) / 40

;性欲素質 1=+20% -1=-20%
LOCAL = LOCAL * (10 + TALENT:ARG:性欲 * 2) / 10

;乱数で-20%～+20%まで上下
LOCAL = LOCAL * (100 + RAND:40 - 19) / 100

BASE:ARG:性欲 = MIN(BASE:ARG:性欲 + LOCAL, MAXBASE:ARG:性欲)

;発情期は常時最大値の8割保証。ドラフ系ならば6割保証
IF CFLAG:TARGET:発情期フラグ < 0
	IF TALENT:ARG:種族 == 2 || TALENT:ARG:発情期あり
		BASE:ARG:性欲 = MAX(BASE:ARG:性欲, MAXBASE:ARG:性欲 * 8 / 10)
	ELSEIF TALENT:ARG:種族 == 3 || ARG == 11
		BASE:ARG:性欲 = MAX(BASE:ARG:性欲, MAXBASE:ARG:性欲 * 6 / 10)
	ENDIF
ENDIF


@性欲ゲージ減少処理(キャラ番号)
#DIM キャラ番号

;うふふ後、消費体力に応じて性欲ゲージ減少
;うふふ終了時以外に呼んでも当然なにもならない

BASE:キャラ番号:性欲 = MAX(0, BASE:キャラ番号:性欲 - TCVAR:キャラ番号:うふふ中消費体力累積)

;ついでに絶頂累積消去
TCVAR:キャラ番号:うふふ中Ｃ絶頂累積 = 0
TCVAR:キャラ番号:うふふ中Ｂ絶頂累積 = 0
TCVAR:キャラ番号:うふふ中Ｖ絶頂累積 = 0
TCVAR:キャラ番号:うふふ中Ａ絶頂累積 = 0
TCVAR:キャラ番号:うふふ中Ｓ絶頂累積 = 0
TCVAR:キャラ番号:うふふ中消費体力累積 = 0
