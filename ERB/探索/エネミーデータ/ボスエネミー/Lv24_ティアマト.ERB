@敵BATTLE_STATE_Lv24_ティアマト(対象エネミー)
#DIM 対象エネミー
敵BATTLE_STATE:対象エネミー:Lv = 24
敵BATTLE_STATE:対象エネミー:最大ＨＰ = 32970
敵BATTLE_STATE:対象エネミー:ＨＰ = 32970
敵BATTLE_STATE:対象エネミー:攻撃力 = 890
敵BATTLE_STATE:対象エネミー:防御力 = 750
敵BATTLE_STATE:対象エネミー:回復力 = 0
敵BATTLE_STATE:対象エネミー:行動速度 = 999
敵BATTLE_STATE:対象エネミー:DA率 = 60
敵BATTLE_STATE:対象エネミー:TA率 = 0
敵BATTLE_STATE:対象エネミー:命中率 = 110
敵BATTLE_STATE:対象エネミー:回避率 = 5
敵BATTLE_STATE:対象エネミー:属性 = 5
敵BATTLE_STATE:対象エネミー:所持EXP = 2810
敵BATTLE_STATE:対象エネミー:所持ルピ = 3230
敵BATTLE_STATE:対象エネミー:最大チャージターン = 3

敵BATTLE_STATE:対象エネミー:ボスフラグ = 1
敵BATTLE_STATE:対象エネミー:ランダム不許可フラグ = 1

敵BATTLE_STATE_STR:対象エネミー:種族 = 星晶獣


; @敵討伐後処理_Lv24_ティアマト(隊列番号)
; #DIM 隊列番号
; #DIM ドロップ確率
; #DIMS ドロップアイテム
; #DIM データベース行数
; #DIM トレハンLv

; トレハンLv = 0
; データベース行数 = デバフ番号取得("ドロップ率UP")
; SIF データベース行数 > -1
; 	トレハンLv = DT_CELL_GET(@"デバフデータベース_{隊列番号}", データベース行数, "デバフ効果量_固定値")

; ドロップ確率 = 30 + トレハンLv * 2
; ドロップアイテム = 白銀の古紋
; CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

; ドロップ確率 = 5 + トレハンLv * 2
; ドロップアイテム = 七星剣の欠片
; CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)


@敵トリガー行動_Lv24_ティアマト
#DIM 一時用

IF バフ番号取得_枠("大技待機", 戦闘行動キャラ) > -1
	;大技待機の次のターンに乱壊のテンペスト
	アビ汎用文字列:実行時メッセージ１ = %敵BATTLE_STATE_STR:(戦闘行動キャラ - 10):エネミー名%の起こした猛烈な風が地上に吹き付けられる！
	アビ汎用文字列:実行時メッセージ２ = %敵BATTLE_STATE_STR:(戦闘行動キャラ - 10):エネミー名%の乱壊のテンペスト！
	アビテンプレート用_アビ名 = 乱壊のテンペスト

	CALL アビ対象選択テンプレート_味方ランダムＸ体(5)
	アビ汎用変数:効果割合 = 250
	CALL アビテンプレート_ダメージ処理_自属性
	
	行動種別フラグ:戦闘行動キャラ:大技発動 = 1
	CALL 大技待機解除(戦闘行動キャラ)
	RETURN 1
ELSEIF 敵BATTLE_STATE:(戦闘行動キャラ - 10):ＨＰ < 敵BATTLE_STATE:(戦闘行動キャラ - 10):最大ＨＰ / 3 && !GETBIT(敵BATTLE_STATE:(戦闘行動キャラ - 10):トリガー行動フラグ, 0)
	;HPが1/3未満になったら真の力解放＋大技待機
	アビ汎用文字列:実行時メッセージ１ = %敵BATTLE_STATE_STR:(戦闘行動キャラ - 10):エネミー名%は真の力を解放すると、風をまとい力を溜め始めた！！
	アビテンプレート用_アビ名 = 真の力解放

	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:特殊表示オプション = 1
	アビ汎用変数:消去不可オプション = 1
	アビ汎用文字列:バフ・デバフ枠 = 大技待機
	アビ汎用文字列:バフ・デバフ対象能力 = 大技待機
	アビ汎用変数:持続ターン = -1
	CALL アビテンプレート_有利効果_バフ効果セット

	;ステータスが変化
	一時用 = 敵BATTLE_STATE:(戦闘行動キャラ - 10):防御力 / 5
	敵BATTLE_STATE:(戦闘行動キャラ - 10):攻撃力 += 一時用 * 2
	敵BATTLE_STATE:(戦闘行動キャラ - 10):行動速度 += 一時用
	敵BATTLE_STATE:(戦闘行動キャラ - 10):防御力 -= 一時用
	敵BATTLE_STATE:(戦闘行動キャラ - 10):DA率 += 40
	敵BATTLE_STATE:(戦闘行動キャラ - 10):チャージターン = 0
	敵BATTLE_STATE:(戦闘行動キャラ - 10):最大チャージターン = 2

	;HPトリガー使い終わったのでフラグを立てる
	SETBIT 敵BATTLE_STATE:(戦闘行動キャラ - 10):トリガー行動フラグ, 0
	RETURN 1
ELSEIF 敵BATTLE_STATE:(戦闘行動キャラ - 10):ＨＰ < 敵BATTLE_STATE:(戦闘行動キャラ - 10):最大ＨＰ * 2 / 3 && 現在ターン数 % 3 == 0
	;HPが2/3未満から、3の倍数ターンはトルネードディザスター
	アビテンプレート用_アビ名 = トルネードディザスター
	
	CALL アビ対象選択テンプレート_味方全体_生者のみ
	アビ汎用変数:効果割合 = 60
	CALL アビテンプレート_ダメージ処理_自属性

	CALL アビ汎用変数文字列リセット
	アビ汎用変数:効果量 = 15
	CALL アビテンプレート_不利効果_奥義ゲージDOWN

	RETURN 1
ENDIF


@敵チャージ行動_Lv24_ティアマト
IF GETBIT(敵BATTLE_STATE:(戦闘行動キャラ - 10):トリガー行動フラグ, 0)
	;真の力解放後は大技待機
	アビ汎用文字列:実行時メッセージ１ = %敵BATTLE_STATE_STR:(戦闘行動キャラ - 10):エネミー名%が風をまとい力を溜め始めた！！
	アビテンプレート用_アビ名 = 大技待機

	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:特殊表示オプション = 1
	アビ汎用変数:消去不可オプション = 1
	アビ汎用文字列:バフ・デバフ枠 = 大技待機
	アビ汎用文字列:バフ・デバフ対象能力 = 大技待機
	アビ汎用変数:持続ターン = -1
	CALL アビテンプレート_有利効果_バフ効果セット
ELSE
	;真の力解放前はバックドラフト
	アビ汎用文字列:実行時メッセージ１ = %敵BATTLE_STATE_STR:(戦闘行動キャラ - 10):エネミー名%は起こした風が爆発を起こす！
	アビ汎用文字列:実行時メッセージ２ = %敵BATTLE_STATE_STR:(戦闘行動キャラ - 10):エネミー名%のバックドラフト！
	アビテンプレート用_アビ名 = バックドラフト

	CALL アビ対象選択テンプレート_味方全体_生者のみ
	アビ汎用変数:効果割合 = 100
	CALL アビテンプレート_ダメージ処理_自属性
	CALL アビテンプレート_ダメージ処理_火属性

	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = アビリティ封印
	アビ汎用文字列:バフ・デバフ対象能力 = アビリティ封印
	アビ汎用変数:持続ターン = 2
	アビ汎用変数:基礎成功確率 = 40
	CALL アビテンプレート_不利効果_デバフ効果セット

	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:効果割合 = 20
	アビ汎用文字列:バフ・デバフ枠 = 防御力A
	アビ汎用文字列:バフ・デバフ対象能力 = 防御力
	アビ汎用変数:持続ターン = 3
	アビ汎用変数:弱体耐性貫通オプション = 1
	CALL アビテンプレート_不利効果_デバフ効果セット
ENDIF
