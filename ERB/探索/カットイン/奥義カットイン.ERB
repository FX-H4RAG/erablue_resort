@奥義カットイン
;アニメが作成できれば1、できなかったときは0を返す
#DIM レイヤー番号
#DIM キャラTEMP
#DIMS 作成アニメ種類
VARSET 作成アニメ種類

レイヤー番号 = 50
;+20 読み込み +40 描画パレットに使用

;戦闘行動キャラを対象に
キャラTEMP = BATTLE_STATE:戦闘行動キャラ:キャラ番号
CSTR:キャラTEMP:画像フォルダ = {NO:キャラTEMP}%CALLNAME:キャラTEMP%

;---------------読み込み画像選択
GDISPOSE レイヤー番号 + 20
RESULT = 0

;アニメ選択オプションを確認する
SELECTCASE アニメ選択オプション
	CASE アニメ選択オプションが横カットイン優先のとき
		作成アニメ種類 = 横カットイン
		GCREATEFROMFILE レイヤー番号 + 20, @"%CSTR:キャラTEMP:画像フォルダ%/横カットイン.png"
	CASE アニメ選択オプションが縦カットイン優先のとき
		作成アニメ種類 = 縦カットイン
		GCREATEFROMFILE レイヤー番号 + 20, @"%CSTR:キャラTEMP:画像フォルダ%/縦カットイン.png"
ENDSELECT

;画像がないまたはアニメ選択オプションがデフォルトならデフォルト画像を使う
IF RESULT == 0
	作成アニメ種類 = デフォルト
	GCREATEFROMFILE レイヤー番号 + 20, @"%CSTR:キャラTEMP:画像フォルダ%/顔_デフォルト.png"
	IF RESULT == 0
		RETURN 0
	ENDIF
ENDIF


SELECTCASE 作成アニメ種類
;-----------------横カットイン
	CASE "横カットイン"
		FOR LOCAL ,0 ,10
			GDISPOSE レイヤー番号 + LOCAL
			GCREATE レイヤー番号 + LOCAL, 900, 900
		NEXT
		GDISPOSE レイヤー番号 + 20
		GCREATEFROMFILE レイヤー番号 + 20, @"%CSTR:キャラTEMP:画像フォルダ%/横カットイン.png"

		;-------------描画と透明化処理
		CALL カットイン用カラーマトリクス取得("透明度_80")
		GDRAWG レイヤー番号 + 0, レイヤー番号 + 20, 180, 300, 630, 315, 0, 0,  GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20), カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 1, レイヤー番号 + 0, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_40")
		GDRAWG レイヤー番号 + 1, レイヤー番号 + 20, 150, 300, 630, 315, 0, 0,  GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20), カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 2, レイヤー番号 + 1, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 2, レイヤー番号 + 20, 120, 300, 630, 315, 0, 0,  GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20), カットイン用カラーマトリクス:0:0

		CALL カットイン用カラーマトリクス取得("透明度_40")
		GDRAWG レイヤー番号 + 3, レイヤー番号 + 20, 90,  300, 630, 315, 0, 0,  GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20), カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 3, レイヤー番号 + 2, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_80")
		GDRAWG レイヤー番号 + 4, レイヤー番号 + 20, 60,  300, 630, 315, 0, 0,  GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20), カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 4, レイヤー番号 + 3, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0

		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 5, レイヤー番号 + 4, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_60")
		GDRAWG レイヤー番号 + 6, レイヤー番号 + 5, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_60")
		GDRAWG レイヤー番号 + 7, レイヤー番号 + 6, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_60")
		GDRAWG レイヤー番号 + 8, レイヤー番号 + 7, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0

		SPRITEDISPOSE "カットインアニメ_0"

		;----------アニメーション画像の合成
		SPRITEANIMECREATE "カットインアニメ_0", 900, 900
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 0, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 1, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 2, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 3, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 4, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 5, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 6, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 7, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 8, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 9, 0, 0, 180, 180,   0,   0, 10000
;------------縦カットイン
	CASE "縦カットイン"
		FOR LOCAL ,0 ,10
			GDISPOSE レイヤー番号 + LOCAL
			GCREATE レイヤー番号 + LOCAL, 900, 900
		NEXT
			GDISPOSE レイヤー番号 + 20
			GCREATEFROMFILE レイヤー番号 + 20, @"%CSTR:キャラTEMP:画像フォルダ%/縦カットイン.png"

		;-------------描画と透明化処理
		CALL カットイン用カラーマトリクス取得("透明度_80")
		GDRAWG レイヤー番号 + 0, レイヤー番号 + 20, 345, 150, 270, 540, 0, 0, GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20) , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 1, レイヤー番号 + 0, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_40")
		GDRAWG レイヤー番号 + 1, レイヤー番号 + 20, 345, 180, 270, 540, 0, 0, GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20) , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 2, レイヤー番号 + 1, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 2, レイヤー番号 + 20, 345, 210, 270, 540, 0, 0, GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20) , カットイン用カラーマトリクス:0:0

		CALL カットイン用カラーマトリクス取得("透明度_40")
		GDRAWG レイヤー番号 + 3, レイヤー番号 + 20, 345, 240, 270, 540, 0, 0, GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20) , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 3, レイヤー番号 + 2, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_80")
		GDRAWG レイヤー番号 + 4, レイヤー番号 + 20, 345, 270, 270, 540, 0, 0, GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20) , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 4, レイヤー番号 + 3, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 5, レイヤー番号 + 4, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_60")
		GDRAWG レイヤー番号 + 6, レイヤー番号 + 5, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_60")
		GDRAWG レイヤー番号 + 7, レイヤー番号 + 6, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_60")
		GDRAWG レイヤー番号 + 8, レイヤー番号 + 7, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0

		SPRITEDISPOSE "カットインアニメ_0"

		;-----------アニメーション合成
		SPRITEANIMECREATE "カットインアニメ_0", 900, 900

		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 0, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 1, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 2, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 3, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 4, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 5, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 6, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 7, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 8, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 9, 0, 0, 900, 900,   0,   0, 10000
;----------------デフォルトカットイン
	CASE "デフォルト"
		FOR LOCAL ,0 ,10
			GDISPOSE レイヤー番号 + LOCAL
			GCREATE レイヤー番号 + LOCAL, 900, 900
		NEXT
		GCREATEFROMFILE レイヤー番号 + 20, @"%CSTR:キャラTEMP:画像フォルダ%/顔_デフォルト.png"
			GDISPOSE レイヤー番号 + 40
			GCREATE レイヤー番号 + 40, 900, 900
			GDRAWG レイヤー番号 + 40, レイヤー番号 + 20, 0, 450, 900, 900, 0, (GHEIGHT(レイヤー番号 + 20) / 4),  GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20)
			;上下を切り取る
			GDISPOSE レイヤー番号 + 20
			GCREATE レイヤー番号 + 20, 900, 450
			GDRAWG レイヤー番号 + 20, レイヤー番号 + 40, 0, 0, 900, 900, 0, 450, 900, 900
			;もとのGIDに返す

		;-------------描画と透明化処理
		CALL カットイン用カラーマトリクス取得("透明度_80")
		GDRAWG レイヤー番号 + 0, レイヤー番号 + 20, 180, 300, 630, 315, 0, 0,  GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20), カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 1, レイヤー番号 + 0, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_40")
		GDRAWG レイヤー番号 + 1, レイヤー番号 + 20, 150, 300, 630, 315, 0, 0,  GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20), カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 2, レイヤー番号 + 1, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 2, レイヤー番号 + 20, 120, 300, 630, 315, 0, 0,  GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20), カットイン用カラーマトリクス:0:0

		CALL カットイン用カラーマトリクス取得("透明度_40")
		GDRAWG レイヤー番号 + 3, レイヤー番号 + 20, 90,  300, 630, 315, 0, 0,  GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20), カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 3, レイヤー番号 + 2, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_80")
		GDRAWG レイヤー番号 + 4, レイヤー番号 + 20, 60,  300, 630, 315, 0, 0,  GWIDTH (レイヤー番号 + 20), GHEIGHT(レイヤー番号 + 20), カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 4, レイヤー番号 + 3, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0

		CALL カットイン用カラーマトリクス取得("透明度_00")
		GDRAWG レイヤー番号 + 5, レイヤー番号 + 4, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_60")
		GDRAWG レイヤー番号 + 6, レイヤー番号 + 5, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_60")
		GDRAWG レイヤー番号 + 7, レイヤー番号 + 6, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0
		CALL カットイン用カラーマトリクス取得("透明度_60")
		GDRAWG レイヤー番号 + 8, レイヤー番号 + 7, 0, 0, 900, 900, 0, 0, 900, 900 , カットイン用カラーマトリクス:0:0

		SPRITEDISPOSE "カットインアニメ_0"

		;----------アニメーション画像の合成
		SPRITEANIMECREATE "カットインアニメ_0", 900, 900
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 0, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 1, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 2, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 3, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 4, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 5, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 6, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 7, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 8, 0, 0, 900, 900,   0,   0,  90
		SPRITEANIMEADDFRAME "カットインアニメ_0", レイヤー番号 + 9, 0, 0, 180, 180,   0,   0, 10000

ENDSELECT

RETURN 1

