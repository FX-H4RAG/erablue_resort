
@イベント_リゾート島開拓作業_ランダム_調合知識イベ１
CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = 妙な形の葉っぱを付けた低木の群生地を見つけた。
	CALL 知識技能所持者検索("調合知識", 1)
	LOCAL = RESULT
	IF LOCAL > -1
		WSTR:(K++) = %CALLNAME:LOCAL%はその葉っぱがポーションに使われる薬草になることに気づいた。
		WSTR:(K++) = この場で調合すれば即席のポーションとして使えるだろう。
		WSTR:(K++) = 日持ちしない薬草のためこの探索中にしか持たないが、十分役立つはずだ。
		LOCAL:1 = RAND:3 + 1
		KSTR:(K++) = %CALLNAME:PLAYER%たちは「即席オールポーション」を{LOCAL:1}個に手に入れた！
		CALL アイテム増減汎用処理("即席オールポーション", LOCAL:1)
		ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	ELSE
		WSTR:(K++) = %CALLNAME:PLAYER%たちにはそれ以上のことはわからなかった。
		KSTR:(K++) = 調合知識があればどんな樹木かわかったかもしれないが……。
	ENDIF
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_調合知識イベ２
CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = 妙な形の葉っぱを付けた低木の群生地を見つけた。
	CALL 知識技能所持者検索("調合知識", 1)
	LOCAL = RESULT
	IF LOCAL > -1
		WSTR:(K++) = %CALLNAME:LOCAL%はその木が魔力を貯蔵する実を付けていることに気づいた。
		WSTR:(K++) = 収穫してしまうとすぐに魔力は霧散してしまうが、この場で回復するには問題ない。
		LOCAL:1 = RAND:3 + 1
		KSTR:(K++) = %CALLNAME:PLAYER%たちのＭＰが{LOCAL:1 * 50}回復した！
		CALL 探索中全体回復_ＭＰ(LOCAL:1 * 50)
		ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	ELSE
		WSTR:(K++) = %CALLNAME:PLAYER%たちにはそれ以上のことはわからなかった。
		KSTR:(K++) = 調合知識があればどんな樹木かわかったかもしれないが……。
	ENDIF
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_調合知識イベ３
CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = 妙な形の葉っぱを付けた低木の群生地を見つけた。
	CALL 知識技能所持者検索("調合知識", 1)
	LOCAL = RESULT
	IF LOCAL > -1
		WSTR:(K++) = %CALLNAME:LOCAL%はその葉っぱが一時的な魔力向上薬になることに気づいた。
		WSTR:(K++) = 調合した薬を飲むと、君たちの体に力が漲る！
		KSTR:(K++) = %CALLNAME:PLAYER%たちの奥義が即座に発動可能になった！
		CALL 探索中全体回復_奥義ゲージ(100)
		ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	ELSE
		WSTR:(K++) = %CALLNAME:PLAYER%たちにはそれ以上のことはわからなかった。
		KSTR:(K++) = 調合知識があればどんな樹木かわかったかもしれないが……。
	ENDIF
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_魔法知識イベ１
CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = 岩の陰に魔力を感じる石を見つけた。
	KSTR:(K++) = 拾ってみますか？
	KSTR:(K++) = BUTTON_[はい]
	KSTR:(K++) = BUTTON_[いいえ]
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[はい]"
			CALL 知識技能所持者検索("魔法知識", 1)
			LOCAL = RESULT
			IF LOCAL > -1
				WSTR:(K++) = %CALLNAME:LOCAL%が鑑定したところ、どうやら騎空艇の動力になる風の魔石のようだ。
				WSTR:(K++) = 持ち帰って売ればそこそこの金になるだろう！
				KSTR:(K++) = %CALLNAME:PLAYER%たちは５万ルピを手に入れた。
				MONEY += 50000
			ELSE
				WSTR:(K++) = 何かはわからないが、綺麗な魔石だ。
				WSTR:(K++) = 持ち帰って売れば換金出来るかもしれない。
				KSTR:(K++) = %CALLNAME:PLAYER%たちは１万ルピを手に入れた。
				MONEY += 10000
			ENDIF
			ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
		CASE "[いいえ]"
			WSTR:(K++) = 下手に触ると何が起こるかわからず危険だ。放置しよう。
			KSTR:(K++) = 魔法知識があれば利用出来たかもしれないが……。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE
			GOTO LOOP_MESSAGE
	ENDSELECT
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_魔法知識イベ２
#DIM ダメージ量

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = 岩の陰に魔力を感じる石を見つけた。
	KSTR:(K++) = 拾ってみますか？
	KSTR:(K++) = BUTTON_[はい]
	KSTR:(K++) = BUTTON_[いいえ]
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[はい]"
			CALL 知識技能所持者検索("魔法知識", 1)
			LOCAL = RESULT
			IF LOCAL > -1
				WSTR:(K++) = 近づいてみると、%CALLNAME:LOCAL%はそれが火の魔石であることに気づいた。
				WSTR:(K++) = うっかり触っていたら炎が噴き出して怪我をしてしまっていただろう。
				WSTR:(K++) = %CALLNAME:LOCAL%は魔石から余計な魔力を取り除き、魔石を簡単な道具として加工した。
				LOCAL:1 = RAND:3 + 1
				KSTR:(K++) = %CALLNAME:PLAYER%たちは「火の魔石」を{LOCAL:1}個に手に入れた！
				CALL アイテム増減汎用処理("火の魔石", LOCAL:1)
			ELSE
				WSTR:(K++) = 近づいてみると、突然魔石から炎が噴き出した！！
				ダメージ量 = ＰＴ内最大レベル算出() * 20
				KSTR:(K++) = %CALLNAME:PLAYER%たち全員のＨＰに{ダメージ量}のダメージ！

				CALL メッセージ欄表示用関数()
				CALL 口上変数初期化
				CALL 探索中全体ダメージ_ＨＰ_致死(ダメージ量)

				WSTR:(K++) = どうやら火の魔石に魔力が溜まりすぎていたようだ。
				WSTR:(K++) = 魔力を使い切った魔石はただの石ころになってしまっている……。
				KSTR:(K++) = 魔法知識があれば防げたかもしれないが……気を取り直して君たちは先に進む。
			ENDIF
			ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
		CASE "[いいえ]"
			WSTR:(K++) = 下手に触ると何が起こるかわからず危険だ。放置しよう。
			KSTR:(K++) = 魔法知識があれば利用出来たかもしれないが……。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_魔法知識イベ３
CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = 岩の陰に魔力を感じる石を見つけた。
	KSTR:(K++) = 拾ってみますか？
	KSTR:(K++) = BUTTON_[はい]
	KSTR:(K++) = BUTTON_[いいえ]
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[はい]"
			CALL 知識技能所持者検索("魔法知識", 1)
			LOCAL = RESULT
			IF LOCAL > -1
				WSTR:(K++) = 近づいてみると、%CALLNAME:LOCAL%はそれが光の魔石であることに気づいた。
				WSTR:(K++) = 生命を司る魔力が治癒の力を大きく増加させる……！
				WSTR:(K++) = %CALLNAME:LOCAL%は魔石の魔力を使い、戦闘不能を含む全員のＨＰを１００回復した！
				CALL 探索中全体回復_ＨＰ_蘇生(100)
			ELSE
				WSTR:(K++) = 近づいてみると、突然魔石から温かな光が湧き出した。
				WSTR:(K++) = 光に包まれた君たちの傷が癒えていく……。
				KSTR:(K++) = %CALLNAME:PLAYER%たちのＨＰが１００回復した！
				CALL メッセージ欄表示用関数()
				CALL 探索中全体回復_ＨＰ(100)
				CALL 口上変数初期化
				WSTR:(K++) = どうやら光の魔石に魔力が溜まりすぎていたようだ。
				WSTR:(K++) = 魔力を使い切った魔石はただの石ころになってしまっている……。
				KSTR:(K++) = 魔法知識があればもっと有効に使えたかもしれないが……気を取り直して君たちは先に進む。
			ENDIF
			ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
		CASE "[いいえ]"
			WSTR:(K++) = 下手に触ると何が起こるかわからず危険だ。放置しよう。
			KSTR:(K++) = 魔法知識があれば利用出来たかもしれないが……。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_機械知識イベ１
#DIMS ドロップアイテム

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = 地面に横たわり、朽ちかけたアイアンゴーレムを発見した。
	KSTR:(K++) = 近づいてみますか？
	KSTR:(K++) = BUTTON_[はい]
	KSTR:(K++) = BUTTON_[いいえ]
	CALL 知識技能所持者検索("機械知識", 1)
	LOCAL = RESULT
	IF LOCAL > -1
		KSTR:(K++) = BUTTON_[%CALLNAME:LOCAL%が遠くから観察してみる]
	ELSE
		LOCAL = 0
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[はい]"
			IF RAND:2
				WSTR:(K++) = 近づいてよく見てみると、朽ちているのは表面だけで内部の機構はまだ使うことが出来そうだ。
				WSTR:(K++) = 分解して状態が良い部品を回収しよう。
				ドロップアイテム = %ランダム素材名("ダンジョン素材", RAND:3)%
				LOCAL = RAND:3 + 2
				WSTR:(K++) = %CALLNAME:PLAYER%は%ドロップアイテム%を{LOCAL}個手に入れた！
				CALL 素材入手処理(ドロップアイテム, LOCAL)
			ELSE
				WSTR:(K++) = 近づいてみると、突然ゴーレムの機体が異音を立てて爆発した！
				KSTR:(K++) = %CALLNAME:PLAYER%たちのＨＰが{ダンジョン階層記録 * 50}減少した！
				CALL メッセージ欄表示用関数()
				CALL 探索中全体ダメージ_ＨＰ_非致死(ダンジョン階層記録 * 50)
				CALL 口上変数初期化
				WSTR:(K++) = どうやら朽ちているように見えて、動力部だけは生きていたようだ。
				WSTR:(K++) = 部品の類も吹っ飛んでしまっており、回収できそうな部品は残っていない。
				KSTR:(K++) = 収穫がなかったことを残念に思いながら、気を取り直して君たちは先に進む。
			ENDIF
			ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
		CASE "[いいえ]"
			WSTR:(K++) = 下手に触ると何が起こるかわからず危険だ。放置しよう。
		CASE @"[%CALLNAME:LOCAL%が遠くから観察してみる]"
			IF RAND:2
				WSTR:(K++) = 露出している機械部分は光を失っており、耳を澄ませてみても駆動音は聞こえない…
				WSTR:(K++) = %CALLNAME:LOCAL%はあのゴーレムは安全だと判断した。
				WSTR:(K++) = 改めて近づいてみると、朽ちているのは表面だけで内部の機構はまだ使うことが出来そうだ。
				WSTR:(K++) = 分解して状態が良い部品を回収しよう。
				ドロップアイテム = %ランダム素材名("ダンジョン素材", RAND:3)%
				LOCAL = RAND:3 + 2
				WSTR:(K++) = %CALLNAME:PLAYER%は%ドロップアイテム%を{LOCAL}個手に入れた！
				CALL 素材入手処理(ドロップアイテム, LOCAL)
			ELSE
				WSTR:(K++) = 露出している機械部分は光を失っているが、耳を澄ませてみると微かに駆動音が聞こえる…
				WSTR:(K++) = %CALLNAME:LOCAL%はあのゴーレムは危険だと判断した。
				KSTR:(K++) = 遠くから石を投げて刺激してみると、突然ゴーレムの機体が異音を立てて爆発した！_PAGE
				WSTR:(K++) = どうやら朽ちているように見えて、動力部だけは生きていたようだ。
				WSTR:(K++) = 部品の類も吹っ飛んでしまっており、回収できそうな部品は残っていない。
				KSTR:(K++) = 収穫がなかったことを残念だが、安全に処理出来たことに安堵しながら君たちは先に進む。
			ENDIF
			ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_機械知識イベ２
#DIMS ドロップアイテム

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:PLAYER%たちは野生の獣型ゴーレムと遭遇した。
	WSTR:(K++) = 咄嗟に戦闘態勢を取るが、ゴーレムは動かない。どうやらこちらへの敵意はないようだ。
	KSTR:(K++) = 近づいてみますか？
	KSTR:(K++) = BUTTON_[はい]
	KSTR:(K++) = BUTTON_[いいえ]
	CALL 知識技能所持者検索("機械知識", 1)
	LOCAL = RESULT
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[はい]"
			WSTR:(K++) = 近づいてよく見てみると、ちかちかとランプが規則的に点滅していることがわかる。
			IF LOCAL > -1
				WSTR:(K++) = %CALLNAME:LOCAL%が点滅するパターンを数えてみると、騎空艇でよく使われる通信の合図と一致することがわかった。
				WSTR:(K++) = 解読すると……「コ・コ・ホ・レ・ワ・ン・ワ・ン」と言っているらしい……。
				ドロップアイテム = %TEXTR("渦琥珀/オルディネシュタイン/宝晶原石/星晶の欠片")%
				WSTR:(K++) = 試しに地面を掘ってみると、地中から%ドロップアイテム%が出てきた！
				KSTR:(K++) = %CALLNAME:LOCAL%たちは%ドロップアイテム%を1個手に入れた！_PAGE
				CALL 素材入手処理(ドロップアイテム, 1)
				WSTR:(K++) = ゴーレムは満足したのかランプを消し、その場に横たわって休憩し始めた。
				KSTR:(K++) = 手に入れた宝石をありがたく貰い、君たちはゴーレムから離れて先に進む。
			ELSE
				WSTR:(K++) = なにかを伝えようとしているみたいだが、%CALLNAME:PLAYER%たちにはわからなかった……
				WSTR:(K++) = 機械の知識がある者ならわかるかもしれないが、今は解読する方法はない。
				KSTR:(K++) = 仕方なくゴーレムと別れ、君たちは先に進む。
			ENDIF
		CASE "[いいえ]"
			WSTR:(K++) = 敵対しないなら無理に関わる必要もないだろう。
			KSTR:(K++) = 君たちはゴーレムから離れ、先に進む。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_錬金知識イベ１
#DIMS ドロップアイテム
#DIM 知識２
#DIM 知識１
#DIM 薬効果
#DIM 飲むキャラ

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:PLAYER%たちが探索していると、森から謎の老婆が姿を現した。
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	WSTR:(K++) = 「ふぇっふぇっふぇっ……良い薬があるよ。飲んでみるかい？」
	;薬の効果をここで決定しておく
	薬効果 = RAND:4
	;0:ダメージ　1:何も起こらない　2:HP回復　3:MP回復
	飲むキャラ = 味方ランダム選出()
	CALL メッセージ欄表示用関数(,"怪しい老婆",,0)
	CALL 口上変数初期化
	WSTR:(K++) = 老婆が差し出した薬はボコボコと泡を出しており、どう見ても怪しい……。
	$選択ループ
	KSTR:(K++) = 薬を飲みますか？
	KSTR:(K++) = BUTTON_[はい]
	KSTR:(K++) = BUTTON_[いいえ]
	CALL 知識技能所持者検索("錬金知識", 2)
	知識２ = RESULT
	CALL 知識技能所持者検索("錬金知識", 1)
	知識１ = RESULT
	IF 知識２ >= 0
		KSTR:(K++) = BUTTON_[薬の効果を鑑定する]
	ELSEIF 知識１ >= 0
		KSTR:(K++) = BUTTON_[薬の効果を推理する]
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[はい]"
			WSTR:(K++) = 「それじゃあ、グッと行きな。一気にね。ふぇっふぇっふぇっ……」
			CALL メッセージ欄表示用関数(,"怪しい老婆",,0)
			CALL 口上変数初期化
			SELECTCASE 薬効果
				CASE 0
					WSTR:(K++) = %CALLNAME:(BATTLE_STATE:飲むキャラ:0)%がぐいっと薬を飲むと、エグ味と苦みが口の中を暴れまわる……！
					WSTR:(K++) = %CALLNAME:(BATTLE_STATE:飲むキャラ:0)%のＨＰが1になった！
					CALL メッセージ欄表示用関数(,,,0)
					CALL 口上変数初期化
					BATTLE_STATE:飲むキャラ:ＨＰ = 1
					WSTR:(K++) = %CALLNAME:PLAYER%たちが老婆の方を振り向くと、いつの間にかどこかへ消えてしまっていた。
					KSTR:(K++) = 怪しい物は気軽に飲まない方がいい……そんな教訓を得て、%CALLNAME:PLAYER%たちは探索に戻る。
				CASE 1
					WSTR:(K++) = %CALLNAME:(BATTLE_STATE:飲むキャラ:0)%がぐいっと薬を飲むと、特に何の味もしない……。
					WSTR:(K++) = というか、ただの色が付いた水のようだ。
					CALL メッセージ欄表示用関数(,,,0)
					CALL 口上変数初期化
					BATTLE_STATE:飲むキャラ:ＨＰ = 1
					WSTR:(K++) = %CALLNAME:PLAYER%たちが老婆の方を振り向くと、いつの間にかどこかへ消えてしまっていた。
					KSTR:(K++) = 何だったんだろうか……と不思議に思いながら、%CALLNAME:PLAYER%たちは探索に戻る。
				CASE 2
					WSTR:(K++) = %CALLNAME:(BATTLE_STATE:飲むキャラ:0)%がぐいっと薬を飲むと、身体の疲れや痛みが消えていく……。
					WSTR:(K++) = %CALLNAME:(BATTLE_STATE:飲むキャラ:0)%のＨＰが全快した！
					CALL メッセージ欄表示用関数(,,,0)
					CALL 口上変数初期化
					BATTLE_STATE:飲むキャラ:ＨＰ = BATTLE_STATE:飲むキャラ:最大ＨＰ
					WSTR:(K++) = %CALLNAME:PLAYER%たちが老婆の方を振り向くと、いつの間にかどこかへ消えてしまっていた。
					KSTR:(K++) = お礼を言う暇もなかったことを残念に思いながら、%CALLNAME:PLAYER%たちは探索に戻る。
				CASE 3
					WSTR:(K++) = %CALLNAME:(BATTLE_STATE:飲むキャラ:0)%がぐいっと薬を飲むと、身体中に力が湧き上がる！
					WSTR:(K++) = %CALLNAME:(BATTLE_STATE:飲むキャラ:0)%の奥義ゲージが最大になった！
					CALL メッセージ欄表示用関数(,,,0)
					CALL 口上変数初期化
					BATTLE_STATE:飲むキャラ:奥義ゲージ = BATTLE_STATE:飲むキャラ:ゲージ最大値
					WSTR:(K++) = %CALLNAME:PLAYER%たちが老婆の方を振り向くと、いつの間にかどこかへ消えてしまっていた。
					KSTR:(K++) = お礼を言う暇もなかったことを残念に思いながら、%CALLNAME:PLAYER%たちは探索に戻る。
			ENDSELECT
		CASE "[いいえ]"
			WSTR:(K++) = 何もわからない薬を飲むほど%CALLNAME:PLAYER%たちは無鉄砲ではない。
			KSTR:(K++) = 老婆の申し出を断り、足早にその場を離れた。
		CASE "[薬の効果を鑑定する]"
			SELECTCASE 薬効果
				CASE 0
					WSTR:(K++) = %CALLNAME:知識２%がじっくりと薬を観察してみる……
					WSTR:(K++) = 薬を飲むと体力が大幅に削られてしまう気がする……と%CALLNAME:知識２%は判断したようだ
				CASE 1
					WSTR:(K++) = %CALLNAME:知識２%がじっくりと薬を観察してみる……
					WSTR:(K++) = これは薬ではなくただの水ではないか……と%CALLNAME:知識２%は判断したようだ
				CASE 2
					WSTR:(K++) = %CALLNAME:知識２%がじっくりと薬を観察してみる……
					WSTR:(K++) = 体力を大きく回復する薬のような気がする……と%CALLNAME:知識２%は判断したようだ
				CASE 3
					WSTR:(K++) = %CALLNAME:知識２%がじっくりと薬を観察してみる……
					WSTR:(K++) = 奥義ゲージを大きく回復する薬のような気がする……と%CALLNAME:知識２%は判断したようだ
			ENDSELECT
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			GOTO 選択ループ
		CASE "[薬の効果を推理する]"
			SELECTCASE 薬効果
				CASE 0, 1
					WSTR:(K++) = %CALLNAME:知識１%がじっくりと薬を観察してみる……
					WSTR:(K++) = あまり良い効果ではないような気がする……と%CALLNAME:知識１%は判断したようだ
				CASE 2, 3
					WSTR:(K++) = %CALLNAME:知識１%がじっくりと薬を観察してみる……
					WSTR:(K++) = なんだか良い効果のような気がする……%CALLNAME:知識１%は判断したようだ
			ENDSELECT
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			GOTO 選択ループ
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_錬金知識イベ２
#DIMS ドロップアイテム
#DIM 知識１
#DIM 薬効果

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:PLAYER%たちが探索していると、突然周囲が濃い霧に包まれていく……
	WSTR:(K++) = 天候が変わったのだろうか、瞬く間に一歩先も見えないほどになってしまった。
	$選択ループ
	KSTR:(K++) = どうしたものだろうか？
	KSTR:(K++) = BUTTON_[とにかく進んでみる]
	KSTR:(K++) = BUTTON_[霧が晴れるまでここで待つ]
	CALL 知識技能所持者検索("錬金知識", 1)
	知識１ = RESULT
	IF 知識１ >= 0
		KSTR:(K++) = BUTTON_[錬金術で霧を払う]
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[とにかく進んでみる]"
			WSTR:(K++) = 前に進めばそのうち霧から出られるだろう。とりあえず進んでみる。
			WSTR:(K++) = …………
			SELECTCASE RAND:3
				CASE 0, 1
					WSTR:(K++) = …………ダメだ！　霧の中から出られそうにない。
					KSTR:(K++) = %CALLNAME:PLAYER%たちは疲労でＨＰが 100減少した。
					CALL メッセージ欄表示用関数()
					CALL 口上変数初期化
					
					CALL 探索中全体ダメージ_ＨＰ_非致死(100)
					GOTO 選択ループ
				CASE 2
					WSTR:(K++) = …………なんとか霧の中から抜け出すことに成功したようだ。
					KSTR:(K++) = 見通しの良くなった道と現在地を地図で確認し、%CALLNAME:PLAYER%たちは探索に戻る。
			ENDSELECT
		CASE "[霧が晴れるまでここで待つ]"
			WSTR:(K++) = 下手に動き回るよりは、時間が掛かってもここで待つ方がいいだろう。
			WSTR:(K++) = %CALLNAME:PLAYER%たちは身を寄せ合い、霧が晴れるのをじっと待つ。
			WSTR:(K++) = …………
			KSTR:(K++) = …………_PAGE
			WSTR:(K++) = …………ようやく霧が薄くなってきたようだ。
			WSTR:(K++) = %CALLNAME:PLAYER%たちは精神的に疲弊し、ＭＰが 100減少した。
			KSTR:(K++) = 見通しの良くなった道と現在地を地図で確認し、%CALLNAME:PLAYER%たちは探索に戻る。
			CALL メッセージ欄表示用関数()
			CALL 口上変数初期化
			CALL 探索中全体ダメージ_ＭＰ(100)
		CASE "[錬金術で霧を払う]"
			WSTR:(K++) = %CALLNAME:知識１%は周囲のありふれた素材を使い、霧を払う粉薬を精製した。
			WSTR:(K++) = 作った粉を周囲に撒くと、風に乗ったまま空気中の水分をどんどん吸着して霧が薄くなっていく……。
			WSTR:(K++) = …………探索に支障がない程度まで霧が薄くなった！
			KSTR:(K++) = 見通しの良くなった道と現在地を地図で確認し、%CALLNAME:PLAYER%たちは探索に戻る。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_魔物知識イベ１
#DIMS ドロップアイテム
#DIM 知識１
#DIM 薬効果

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:PLAYER%たちが探索していると、周囲の木々や岩に大きな傷を発見した。
	WSTR:(K++) = 縄張りを示すために魔物が付けた傷のように思えるが、範囲が広い……。
	WSTR:(K++) = この辺りに見合わない強さを持った魔物がうろついているようだ。
	$選択ループ
	KSTR:(K++) = どうしたものだろうか？
	KSTR:(K++) = BUTTON_[放置すると危険だ。魔物を探して討伐する]
	KSTR:(K++) = BUTTON_[慎重を期して一旦ここから離れる]
	CALL 知識技能所持者検索("魔物知識", 1)
	知識１ = RESULT
	IF 知識１ >= 0
		KSTR:(K++) = BUTTON_[魔物を待ち伏せして駆除する]
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[放置すると危険だ。魔物を探して討伐する]"
			WSTR:(K++) = 放置してリゾートの方に出てこられると困る。
			WSTR:(K++) = %CALLNAME:PLAYER%たちは周囲を捜索し、目当ての魔物を見つけ出した。
			KSTR:(K++) = そのまま凶暴な魔物相手に戦いを挑む！
			CALL メッセージ欄表示用関数()

			CALL ランダムエネミーセット関数(2, ダンジョン階層記録 + 5)
			SIF ランダムダンジョン中加護 != ""
				戦闘時_特殊処理フラグ '= ランダムダンジョン中加護
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == -1
				;逃走時
				CALL 口上変数初期化
				CALL 画面再描画
				RETURN 0
			ELSEIF RESULT == 0
				;勝利時
				WSTR:(K++) = %CALLNAME:PLAYER%たちは無事に魔物を討伐した。
				KSTR:(K++) = これで幾らか周囲は安全になっただろう。%CALLNAME:PLAYER%たちは探索に探索に戻った。
			ENDIF
		CASE "[慎重を期して一旦ここから離れる]"
			WSTR:(K++) = いや、まずは準備をしよう。
			KSTR:(K++) = %CALLNAME:PLAYER%たちは一旦この場を離れることにした。
			CALL メッセージ欄表示用関数()
			CALL 口上変数初期化
			CALL 画面再描画
			RETURN 0
		CASE "[魔物を待ち伏せして駆除する]"
			WSTR:(K++) = %CALLNAME:知識１%は周囲の様子を観察し、魔物が移動するルートを割り出した。
			WSTR:(K++) = %CALLNAME:PLAYER%たちはそのルートの近くで待ち伏せ……
			KSTR:(K++) = …………魔物が通りがかった瞬間に一斉攻撃を仕掛けた！_PAGE
			WSTR:(K++) = 魔物はなすすべもなく倒れ、駆除することに成功した。
			KSTR:(K++) = これで幾らか周囲は安全になっただろう。%CALLNAME:PLAYER%たちは探索に探索に戻った。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_魔物知識イベ２
#DIMS ドロップアイテム
#DIM 知識１
#DIM 弱点
#DIM 成功フラグ
#DIM レベルアップフラグ

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	弱点 = RAND:2
	WSTR:(K++) = %CALLNAME:PLAYER%たちが探索していると、特徴的な赤と青の甲殻を持つ魔物が現れた！
	WSTR:(K++) = この魔物は火、もしくは水に弱いが……弱点を間違えると強力な反撃をしてくる習性がある。
	$選択ループ
	KSTR:(K++) = どちらで攻撃すべきだろうか？
	KSTR:(K++) = BUTTON_[火で攻撃だ！]
	KSTR:(K++) = BUTTON_[水で攻撃だ！]
	CALL 知識技能所持者検索("魔物知識", 1)
	知識１ = RESULT
	IF 知識１ >= 0
		KSTR:(K++) = BUTTON_[魔物知識で弱点を看破する]
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[火で攻撃だ！]", "[水で攻撃だ！]"
			成功フラグ = 0
			IF RESULTS == "[火で攻撃だ！]"
				WSTR:(K++) = %CALLNAME:PLAYER%たちは火属性で攻撃した！
				SIF 弱点 == 0
					成功フラグ = 1
			ELSE
				WSTR:(K++) = %CALLNAME:PLAYER%たちは水属性で攻撃した！
				SIF 弱点 == 1
					成功フラグ = 1
			ENDIF
			IF 成功フラグ
				WSTR:(K++) = 魔物は大きな叫び声を上げ、ゆっくりとその場に倒れた。
				WSTR:(K++) = どうやら正しい弱点を突くことが出来たようだ。
				KSTR:(K++) = 魔物を倒した%CALLNAME:PLAYER%たちは、経験値を{ダンジョン階層記録 * 200}手に入れた！
				CALL メッセージ欄表示用関数()
				CALL 口上変数初期化
				レベルアップフラグ = 0
				FOR LOCAL, 0, 14
					SIF LOCAL > 3 && LOCAL < 10
						CONTINUE
					SIF BATTLE_STATE:LOCAL:キャラ登録番号 < 1
						CONTINUE
					基礎BATTLE_STATE:(BATTLE_STATE:LOCAL:キャラ登録番号):蓄積EXP += ダンジョン階層記録 * 200
					CALL レベルアップ処理(BATTLE_STATE:LOCAL:キャラ登録番号)
					SIF レベルアップフラグ < RESULT
						レベルアップフラグ = RESULT
				NEXT
				IF レベルアップフラグ
					;ステータス代入
					CALL 戦闘初期処理_味方
					CALL メッセージ欄表示用関数(,,,0)
					CALL 口上変数初期化
				ENDIF
				KSTR:(K++) = これで幾らか周囲は安全になっただろう。%CALLNAME:PLAYER%たちは探索に戻った。
			ELSE
				WSTR:(K++) = 魔物は大きな叫び声を上げ、興奮した様子で%CALLNAME:PLAYER%たちに襲いかかってきた！
				KSTR:(K++) = %CALLNAME:PLAYER%たちのＨＰが{ダンジョン階層記録 * 30, 4}減少した！
				CALL メッセージ欄表示用関数()
				CALL 口上変数初期化
				
				CALL 探索中全体ダメージ_ＨＰ_非致死(ダンジョン階層記録 * 30)
				WSTR:(K++) = その後、なんとかもう片方の属性を使って魔物を倒すことに成功した。
				KSTR:(K++) = 思わぬ痛手を食らってしまった……次は気をつけよう。%CALLNAME:PLAYER%たちは気を取り直し、探索に戻った。
			ENDIF
		CASE "[魔物知識で弱点を看破する]"
			WSTR:(K++) = %CALLNAME:知識１%は魔物の立ち回りを観察し、%属性数値文字列変換(弱点)%属性が弱点だと見破った！
			WSTR:(K++) = %CALLNAME:PLAYER%たちが正しい属性で攻撃すると、魔物は大きな叫び声を上げてゆっくりとその場に倒れる。
			WSTR:(K++) = 魔物はなすすべもなく倒れ、駆除することに成功した。
			KSTR:(K++) = これで幾らか周囲は安全になっただろう。%CALLNAME:PLAYER%たちは探索に戻った。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画






; 状況：森が異様に静まり返っている。鳥も虫も鳴かない。
; 魔物知識：サイレントスネアという音を吸収する魔物が潜む。獲物を察知させない能力。
; 解決方法：音が消えている範囲を調べ魔物を特定 / 強い音で混乱させて撃退。
; 報酬：「音を消す布」（忍び寄りに役立つアイテム）。
; ③ さまよう巨影

; 状況：草原に大きな影が映るが、姿が見えない。
; 魔物知識：カメレオールという透明化する巨大魔物。特定の角度でしか見えない。
; 解決方法：魔物の足跡や風の流れを頼りに回避 / 泥や粉を撒いて姿を暴く。
; 報酬：「カメレオールの皮」（透明化の素材）。
; ④ 毒の風

; 状況：草原の一角で奇妙な紫色の花が枯れている。
; 魔物知識：バジリステップという魔物が出す毒の影響。毒は特定の風向きで広がる。
; 解決方法：風上を確認し毒を避ける / 解毒薬を作る材料を探す。
; 報酬：「毒の鱗粉」（毒系アイテムの材料）。
; ⑤ 影を落とす翼

; 状況：上空に黒い影が通り過ぎるが、鳴き声がしない。
; 魔物知識：ハングリーホークという獲物の影を追う飛行魔物。自分の影を見失うと狩れない。
; 解決方法：影を消す（霧を発生させる、地下に逃げる）/ 自分の影を別の方向に誘導する。
; 報酬：「ハングリーホークの羽根」（軽量化アイテムの素材）。
; ⑥ 枯れない花

; 状況：森の奥に一輪だけ枯れない花が咲いている。
; 魔物知識：フローラルゴーストという植物のフリをする魔物。近づくと絡みつく。
; 解決方法：日光や火に弱いと知り、ランタンで照らす / 燃えやすい液体を撒いて威嚇。
; 報酬：「霊花の種」（魔法素材）。
; ⑦ 迷いの木立

; 状況：何度進んでも同じ景色が続く。道に迷ったようだ。
; 魔物知識：ミラージュバインという魔法の蔓が錯覚を生む。弱点は銀の反射。
; 解決方法：水面や鏡を使い幻を見破る / 蔦を切り払う。
; 報酬：「幻惑の種」（催眠系魔法の材料）。
; ⑧ 黒い水たまり

; 状況：森の小川が黒く濁っている。飲むべきか？
; 魔物知識：ドロスライムが溶け込んでいる。飲むと体が麻痺する。
; 解決方法：水を浄化する / 火を当ててスライムを炙り出す。
; 報酬：「粘液の塊」（変化系ポーションの材料）。
; ⑨ 鳥が落ちる草原

; 状況：空を飛んでいた鳥が突然落下し、動かなくなる。
; 魔物知識：グラビスネークという重力を操る魔物の仕業。重力場の中心がある。
; 解決方法：重力の影響が弱いルートを探して進む / 魔物を引き寄せ別の場所で倒す。
; 報酬：「重力の鱗」（重量操作アイテムの材料）。
; ⑩ 眠る獣道

; 状況：道の途中で急激な眠気に襲われる。仲間も次々と倒れそうになる。
; 魔物知識：スリープモスという眠り粉を撒く虫の仕業。風向きで影響範囲が変わる。
; 解決方法：眠気を感じたら風上に移動 / 強い匂いで覚醒を維持。
; 報酬：「眠り粉」（催眠アイテムの材料）。



