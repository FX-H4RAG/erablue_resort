@バフターン経過処理(隊列番号, 経過能力 = "", 経過枠 = "")
#DIM 隊列番号
#DIMS 経過枠
#DIMS 経過能力
#DIM データベース行数
#DIM バフ番号
#DIM 持続ターン保存
#DIM 消滅ID保存

IF 経過能力 != ""
	SIF バフ存在チェック(経過能力, 隊列番号) == -1
		RETURN 0
ENDIF
IF 経過枠 != ""
	SIF バフ存在チェック_枠(経過枠, 隊列番号) == -1
		RETURN 0
ENDIF

データベース行数 = DT_ROW_LENGTH(@"バフデータベース_{隊列番号}")
FOR バフ番号, 0, データベース行数
	IF 経過能力 != ""
		SIF DT_CELL_GETS(@"バフデータベース_{隊列番号}", バフ番号, "バフ対象能力") != 経過能力
			CONTINUE
	ENDIF
	IF 経過枠 != ""
		SIF DT_CELL_GETS(@"バフデータベース_{隊列番号}", バフ番号, "バフ枠") != 経過枠
			CONTINUE
	ENDIF
	持続ターン保存 = DT_CELL_GET(@"バフデータベース_{隊列番号}", バフ番号, "持続ターン")
	IF 持続ターン保存 == 1
		CALL バフ削除(隊列番号, バフ番号)
	ELSEIF 持続ターン保存 > 1
		DT_CELL_SET @"バフデータベース_{隊列番号}", バフ番号, "持続ターン", 持続ターン保存 - 1
	ENDIF
NEXT

@デバフターン経過処理(隊列番号, 経過能力 = "", 経過枠 = "")
#DIM 隊列番号
#DIMS 経過枠
#DIMS 経過能力
#DIM データベース行数
#DIM デバフ番号
#DIM 持続ターン保存
#DIM 消滅ID保存

IF 経過能力 != ""
	SIF デバフ存在チェック(経過能力, 隊列番号) == -1
		RETURN 0
ENDIF
IF 経過枠 != ""
	SIF デバフ存在チェック_枠(経過枠, 隊列番号) == -1
		RETURN 0
ENDIF

データベース行数 = DT_ROW_LENGTH(@"デバフデータベース_{隊列番号}")
FOR デバフ番号, 0, データベース行数
	IF 経過能力 != ""
		SIF DT_CELL_GETS(@"デバフデータベース_{隊列番号}", デバフ番号, "デバフ対象能力") != 経過能力
			CONTINUE
	ENDIF
	IF 経過枠 != ""
		SIF DT_CELL_GETS(@"デバフデータベース_{隊列番号}", デバフ番号, "デバフ枠") != 経過枠
			CONTINUE
	ENDIF
	持続ターン保存 = DT_CELL_GET(@"デバフデータベース_{隊列番号}", デバフ番号, "持続ターン")
	IF 持続ターン保存 == 1
		CALL デバフ削除(隊列番号, デバフ番号)
	ELSEIF 持続ターン保存 > 1
		DT_CELL_SET @"デバフデータベース_{隊列番号}", デバフ番号, "持続ターン", 持続ターン保存 - 1
	ENDIF
NEXT

@バフ回数経過処理(隊列番号, 経過能力 = "", 経過枠 = "")
#DIM 隊列番号
#DIMS 経過枠
#DIMS 経過能力
#DIM データベース行数
#DIM バフ番号
#DIM 持続回数保存
#DIM 消滅ID保存

IF 経過能力 != ""
	SIF バフ存在チェック(経過能力, 隊列番号) == -1
		RETURN 0
ENDIF
IF 経過枠 != ""
	SIF バフ存在チェック_枠(経過枠, 隊列番号) == -1
		RETURN 0
ENDIF

データベース行数 = DT_ROW_LENGTH(@"バフデータベース_{隊列番号}")
FOR バフ番号, 0, データベース行数
	IF 経過能力 != ""
		SIF DT_CELL_GETS(@"バフデータベース_{隊列番号}", バフ番号, "バフ対象能力") != 経過能力
			CONTINUE
	ENDIF
	IF 経過枠 != ""
		SIF DT_CELL_GETS(@"バフデータベース_{隊列番号}", バフ番号, "バフ枠") != 経過枠
			CONTINUE
	ENDIF
	持続回数保存 = DT_CELL_GET(@"バフデータベース_{隊列番号}", バフ番号, "持続回数")
	IF 持続回数保存 == 1
		CALL バフ削除(隊列番号, バフ番号)
	ELSEIF 持続回数保存 > 1
		DT_CELL_SET @"バフデータベース_{隊列番号}", バフ番号, "持続回数", 持続回数保存 - 1
	ENDIF
NEXT

@デバフ回数経過処理(隊列番号, 経過能力 = "", 経過枠 = "")
#DIM 隊列番号
#DIMS 経過枠
#DIMS 経過能力
#DIM データベース行数
#DIM デバフ番号
#DIM 持続回数保存
#DIM 消滅ID保存

IF 経過能力 != ""
	SIF デバフ存在チェック(経過能力, 隊列番号) == -1
		RETURN 0
ENDIF
IF 経過枠 != ""
	SIF デバフ存在チェック_枠(経過枠, 隊列番号) == -1
		RETURN 0
ENDIF

データベース行数 = DT_ROW_LENGTH(@"デバフデータベース_{隊列番号}")
FOR デバフ番号, 0, データベース行数
	IF 経過能力 != ""
		SIF DT_CELL_GETS(@"デバフデータベース_{隊列番号}", デバフ番号, "デバフ対象能力") != 経過能力
			CONTINUE
	ENDIF
	IF 経過枠 != ""
		SIF DT_CELL_GETS(@"デバフデータベース_{隊列番号}", デバフ番号, "デバフ枠") != 経過枠
			CONTINUE
	ENDIF
	持続回数保存 = DT_CELL_GET(@"デバフデータベース_{隊列番号}", デバフ番号, "持続回数")
	IF 持続回数保存 == 1
		CALL デバフ削除(隊列番号, デバフ番号)
	ELSEIF 持続回数保存 > 1
		DT_CELL_SET @"デバフデータベース_{隊列番号}", デバフ番号, "持続回数", 持続回数保存 - 1
	ENDIF
NEXT

@バフ行動回数経過処理(隊列番号, 経過能力 = "", 経過枠 = "")
#DIM 隊列番号
#DIMS 経過枠
#DIMS 経過能力
#DIM データベース行数
#DIM バフ番号
#DIM 持続行動回数保存
#DIM 消滅ID保存

IF 経過能力 != ""
	SIF バフ存在チェック(経過能力, 隊列番号) == -1
		RETURN 0
ENDIF
IF 経過枠 != ""
	SIF バフ存在チェック_枠(経過枠, 隊列番号) == -1
		RETURN 0
ENDIF

データベース行数 = DT_ROW_LENGTH(@"バフデータベース_{隊列番号}")
FOR バフ番号, 0, データベース行数
	IF 経過能力 != ""
		SIF DT_CELL_GETS(@"バフデータベース_{隊列番号}", バフ番号, "バフ対象能力") != 経過能力
			CONTINUE
	ENDIF
	IF 経過枠 != ""
		SIF DT_CELL_GETS(@"バフデータベース_{隊列番号}", バフ番号, "バフ枠") != 経過枠
			CONTINUE
	ENDIF
	持続行動回数保存 = DT_CELL_GET(@"バフデータベース_{隊列番号}", バフ番号, "持続行動回数")
	IF 持続行動回数保存 == 1
		CALL バフ削除(隊列番号, バフ番号)
	ELSEIF 持続行動回数保存 > 1
		DT_CELL_SET @"バフデータベース_{隊列番号}", バフ番号, "持続行動回数", 持続行動回数保存 - 1
	ENDIF
NEXT

@デバフ行動回数経過処理(隊列番号, 経過能力 = "", 経過枠 = "")
#DIM 隊列番号
#DIMS 経過枠
#DIMS 経過能力
#DIM データベース行数
#DIM デバフ番号
#DIM 持続行動回数保存
#DIM 消滅ID保存

IF 経過能力 != ""
	SIF デバフ存在チェック(経過能力, 隊列番号) == -1
		RETURN 0
ENDIF
IF 経過枠 != ""
	SIF デバフ存在チェック_枠(経過枠, 隊列番号) == -1
		RETURN 0
ENDIF

データベース行数 = DT_ROW_LENGTH(@"デバフデータベース_{隊列番号}")
FOR デバフ番号, 0, データベース行数
	IF 経過能力 != ""
		SIF DT_CELL_GETS(@"デバフデータベース_{隊列番号}", デバフ番号, "デバフ対象能力") != 経過能力
			CONTINUE
	ENDIF
	IF 経過枠 != ""
		SIF DT_CELL_GETS(@"デバフデータベース_{隊列番号}", デバフ番号, "デバフ枠") != 経過枠
			CONTINUE
	ENDIF
	持続行動回数保存 = DT_CELL_GET(@"デバフデータベース_{隊列番号}", デバフ番号, "持続行動回数")
	IF 持続行動回数保存 == 1
		CALL デバフ削除(隊列番号, デバフ番号)
	ELSEIF 持続行動回数保存 > 1
		DT_CELL_SET @"デバフデータベース_{隊列番号}", デバフ番号, "持続行動回数", 持続行動回数保存 - 1
	ENDIF
NEXT


@バフ削除(隊列番号, バフ番号)
#DIM 隊列番号
#DIM バフ番号
#DIM 消滅ID保存

消滅ID保存 = DT_CELL_GET(@"バフデータベース_{隊列番号}", バフ番号, "id")
TRYCALLFORM バフ消滅時処理_%DT_CELL_GETS(@"バフデータベース_{隊列番号}", バフ番号, "バフ枠")%
DT_ROW_REMOVE @"バフデータベース_{隊列番号}", 消滅ID保存

@デバフ削除(隊列番号, デバフ番号)
#DIM 隊列番号
#DIM デバフ番号
#DIM 消滅ID保存

消滅ID保存 = DT_CELL_GET(@"デバフデータベース_{隊列番号}", デバフ番号, "id")
TRYCALLFORM デバフ消滅時処理_%DT_CELL_GETS(@"デバフデータベース_{隊列番号}", デバフ番号, "デバフ枠")%
DT_ROW_REMOVE @"デバフデータベース_{隊列番号}", 消滅ID保存

