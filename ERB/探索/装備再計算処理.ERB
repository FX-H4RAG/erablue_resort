@装備再計算処理(キャラ番号)
#DIM キャラ番号
#DIM 装備指輪
#DIM 装備耳飾り
#DIM 装備衣装
#DIM ステータス一時計算
VARSET LOCALS

装備指輪 = 装備ステータス補正保存:キャラ番号:装備指輪番号
装備耳飾り = 装備ステータス補正保存:キャラ番号:装備耳飾り番号
装備衣装 = 装備ステータス補正保存:キャラ番号:装備衣装番号
;装備アイテム番号だけ退避させて一端全部消す
VARSET 装備ステータス補正保存:キャラ番号:0

装備ステータス補正保存:キャラ番号:装備指輪番号 = 装備指輪
SPLIT DT_CELL_GETS("所持指輪データベース", 装備指輪, "基礎ステータス補正"), "_", LOCALS
FOR LOCAL:1, 0, 30, 2
	IF LOCALS:(LOCAL:1) == ""
		BREAK
	ENDIF
	装備ステータス補正保存:キャラ番号:(LOCALS:(LOCAL:1)) += TOINT(LOCALS:(LOCAL:1 + 1))
NEXT
SPLIT DT_CELL_GETS("所持指輪データベース", 装備指輪, "オプションステータス補正"), "_", LOCALS
FOR LOCAL:1, 0, 30, 2
	IF LOCALS:(LOCAL:1) == ""
		BREAK
	ENDIF
	装備ステータス補正保存:キャラ番号:(LOCALS:(LOCAL:1)) += TOINT(LOCALS:(LOCAL:1 + 1))
NEXT

装備ステータス補正保存:キャラ番号:装備耳飾り番号 = 装備耳飾り
IF DT_CELL_GETS("所持耳飾りデータベース", 装備耳飾り, "変更属性") != ""
	;0を火属性にしちゃったので数値そのままだと属性変更してるかどうか判別がつかないため、装備による属性変更は属性番号+10で保存
	装備ステータス補正保存:キャラ番号:属性 = 属性文字列数値変換(DT_CELL_GETS("所持耳飾りデータベース", 装備耳飾り, "変更属性")) + 10
ENDIF

装備ステータス補正保存:キャラ番号:装備衣装番号 = 装備衣装
;たぶん現状衣装でステータスが変化することはないので触らない

;その他ステータス補正処理
;料理メニュー補正
IF CFLAG:キャラ番号:滞在期間 > 0
	;一旦装備済みのステータスを計算してから再計算
	ステータス一時計算 = 基礎BATTLE_STATE:キャラ番号:攻撃力 + 装備ステータス補正保存:キャラ番号:攻撃力
	SIF 料理セット判定("焼肉セット")
		装備ステータス補正保存:キャラ番号:攻撃力 += ステータス一時計算 * 5 / 100
	;一旦装備済みのステータスを計算してから再計算
	ステータス一時計算 = 基礎BATTLE_STATE:キャラ番号:命中率 + 装備ステータス補正保存:キャラ番号:命中率
	SIF 料理セット判定("レンズ豆煮込み")
		装備ステータス補正保存:キャラ番号:命中率 += ステータス一時計算 * 5 / 100
ENDIF
