
AUTO_SPLITが欲しかったので、eraMegatenよりライセンスフリーが明記されている独自のSPLIT系式中関数を移植してきました。
以下、ERB\汎用関数\SPLIT\使い方.txt及び各ERBより転載及び抜粋です。

;-------------------------------------------------------------------------------------

SPLITを利用した文字列変数の操作や取り出しなんかを容易にする式中関数群です。

;------------------------------------------------------------------------------------

# @CHANGE_SPLIT(ARGS , ARGS:1 , ARG , ARGS:2 = "")
文字列ARGSをARGS:1(","や"/"など)で分割し、そのARG番目に割り振られた文字列部分をARGS:2に変更して、変更後のARGSを返します
ARGS:2に何も指定しない場合、ARG番目が空文字列になります(要するに削除されます)

使用例：
STR = 女/神/転/生
STR = %CHANGE_SPLIT( STR , "/" , 0 , "魔")%
この場合、"女/神/転/生"だったSTRの中身が、"魔/神/転/生"へと変更されます

STR = 女/神/転/生
STR = %CHANGE_SPLIT( STR , "/" , 2 , "")%
STR = %CHANGE_SPLIT( STR , "/" , 3 , "")%
この場合、"女/神/転/生"だったSTRの中身が、"女/神//"へと変更されます

;-------------------------------------------------------------------------------------

# @AUTO_SPLIT(ARGS , ARGS:1 , ARG = 0 , ARGS:2 = "")
文字列ARGSをARGS:1(","や"/"など)で分割し、そのARG番目に割り振られた文字列部分を返します
ARGS:2に何かを指定すると、ARGS:2に一致する文字列が何番目かを探し、その番号+ARG番目の文字列を返します
ARGS:2を指定しつつARGS:2に一致する文字列が無い場合、空文字列が返されます

使用例：
STR = 女/神/転/生
STR:1 = %AUTO_SPLIT( STR , "/" , 1)%
この場合、STR:1の中身は"神"になります

使用例：
STR = 性別/男
STR:1 = %AUTO_SPLIT( STR , "/" , 1 , "性別")%
この場合、STR:1の中身は"男"になります

;-------------------------------------------------------------------------------------

# @AUTO_SPLIT_NUM(ARGS , ARGS:1 , ARGS:2 = "" , ARG = 0)
文字列ARGSをARGS:1(","や"/"など)で分割し、ARGS:2に一致する文字列が何番目かを探します。
ARGSに数値を指定すると、更にARGを加えた値を返します。
ARGS:2に一致する文字列が存在しない場合、-1が返ってきます。

使用例：
STR = 女/神/転/生
LOCAL = %AUTO_SPLIT_NUM( STR , "/" , "転")%
この場合、LOCALの中身は3になります

STR = 女/神/転/生
LOCAL = %AUTO_SPLIT_NUM( STR , "/" , "転" , -2)%
この場合、LOCALの中身は1になります

;-------------------------------------------------------------------------------------

# @ADD_SPLIT(ARGS , ARGS:1 , ARGS:2 = "")
文字列ARGSをARGS:1(","や"/"など)で分割し、一番若い空文字列にARGS:2を代入したARGSを返します。
ARGSを分割した中に空文字列が無い場合、ARGSがそのまま返ってきます。

使用例：
STR = 女//転/生
STR = %ADD_SPLIT( STR , "/" , "転")%
この場合、"女//転/生"だったSTRの中身が、"女/神/転/生"へと変更されます


;-------------------------------------------------------------------------------------

・組み合わせて使う
例えばあるキャラのCSTRに、"LV/1/力/5/耐力/5"と保存し、後で"力"の後ろを"10"に変更したい場合、以下の様になります

CSTR = "LV/1/力/5/耐力/5"
CSTR = %CHANGE_SPLIT( CSTR , "/" , AUTO_SPLIT_NUM( CSTR , "/" , "力" , 1) , "10")%

これで、CSTRは"LV/1/力/10/耐力/5"へと変更されました。
また、"LV"の後ろの数値に3を加えて4にしたい場合、以下のようにも記述できます

CSTR = "LV/1/力/5/耐力/5"
LOCAL = TOINT(SEACH_SPLIT( CSTR , "/" , 1 , "LV" ) ) 
CSTR = %CHANGE_SPLIT( CSTR , "/" , AUTO_SPLIT_NUM( CSTR , "/" , "LV" , 1) , TOSTR( LOCAL + 3 ))%

これで、CSTRは"LV/4/力/5/耐力/5"へと変更されました。


;-------------------------------------------------------------------------------------
以下、rsp暇人による加筆。間違ってたらごめんなさい
;-------------------------------------------------------------------------------------

# @AUTO_SPLIT_INT
AUTO_SPLITで返される文字列が数値化できる場合、数値に変換して返します。数値化できない（全角数字含む）場合は0を返します。

;-------------------------------------------------------------------------------------

# @CALC_SPLIT(ARGS , ARGS:1 , ARG , ARGS:2 = "" , ARGS:3 = "" , ARGS:4)
文字列ARGSをARGS:1で分割し、そのARG番目に割り振られた文字列部分にARGS:4をARGS:3によって演算して変換した文字列を返します。
ARGS:3は+=、-=、*=、/=、==のいずれかのみ受け付けます。ARGS:3が==の場合、ARGS:4に置換します。
 +=の場合、元の文字列及びARGS:4のどちらも数値化できる場合は加算を、そうでない場合文字列として後方に付け足します。
 それ以外の場合、数値として四則演算を行います。数値化できない文字列の場合は０として演算します。

ARGS:2に何かを指定すると、ARGS:2に一致する文字列が何番目かを探し、その番号+ARG番目の文字列に対して演算します。
ARGS:2を指定しつつARGS:2に一致する文字列がない場合、2連続して開いている箇所があればそこに、なければ文末に0と一緒に追加されます。

また、演算後の数値が正の値の場合、頭に+が付きます
使用例：
STR = 女/1/神/2/転/3/生/4
STR = %CALC_SPLIT( STR , "/" , 1 , "転" ,  "-=" , "2" )%
この場合、STRの中身は"女/1/神/2/転/+1/生/4"になります

STR = 女/1/神/2/転/3/生/4
STR = %CALC_SPLIT( STR , "/" , 2 , "転" ,  "+=" , "回" )%
この場合、STRの中身は"女/1/神/2/転/3/生回/4"になります


;-------------------------------------------------------------------------------------

# @RAND_SPLIT(ARGS, ARGS:1)
文字列ARGSをARGS:1で分割し、その中から一つを等確率でランダムに選び返します。

;-------------------------------------------------------------------------------------

# @SHIFT_SPLIT(ARGS , ARGS:1 , ARG , ARGS:2 = "" , ARG:1 = 0 , ARG:2 = 200)
文字列ARGSを、ARGS:1で分割した場合の文字列をARGだけシフトさせた文字列を返します。
ずらしてできた空白部分にはARGS:2が代入されます。また、ARG:1でずらす範囲の開始地点を、ARG:2でずらす範囲数を指定できます。
STR = 女/神/転/生
STR = %SHIFT_SPLIT( STR , "/" , 2 , "魔")%
この場合、"女/神/転/生"だったSTRの中身が、"魔/魔/女/神/転/生"へと変更されます

-------------------------------------------------------------------------------
ライセンス
-------------------------------------------------------------------------------

-このファイル自体の再配布・改変はご自由にどうぞ
-SPLITフォルダに入っているファイルに関しては、各ファイルの記述をご確認ください

-------------------------------------------------------------------------------
履歴
-------------------------------------------------------------------------------
制作者：Rsp暇人

2023/03/01 新規作成
